{"ast":null,"code":"// Generated by IcedCoffeeScript 108.0.8\n(function () {\n  var BlockCipher,\n      G,\n      Global,\n      TwoFish,\n      scrub_vec,\n      __hasProp = {}.hasOwnProperty,\n      __extends = function (child, parent) {\n    for (var key in parent) {\n      if (__hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  };\n\n  BlockCipher = require('./algbase').BlockCipher;\n  scrub_vec = require('./util').scrub_vec;\n\n  Global = function () {\n    function Global() {\n      this.P = [[0xA9, 0x67, 0xB3, 0xE8, 0x04, 0xFD, 0xA3, 0x76, 0x9A, 0x92, 0x80, 0x78, 0xE4, 0xDD, 0xD1, 0x38, 0x0D, 0xC6, 0x35, 0x98, 0x18, 0xF7, 0xEC, 0x6C, 0x43, 0x75, 0x37, 0x26, 0xFA, 0x13, 0x94, 0x48, 0xF2, 0xD0, 0x8B, 0x30, 0x84, 0x54, 0xDF, 0x23, 0x19, 0x5B, 0x3D, 0x59, 0xF3, 0xAE, 0xA2, 0x82, 0x63, 0x01, 0x83, 0x2E, 0xD9, 0x51, 0x9B, 0x7C, 0xA6, 0xEB, 0xA5, 0xBE, 0x16, 0x0C, 0xE3, 0x61, 0xC0, 0x8C, 0x3A, 0xF5, 0x73, 0x2C, 0x25, 0x0B, 0xBB, 0x4E, 0x89, 0x6B, 0x53, 0x6A, 0xB4, 0xF1, 0xE1, 0xE6, 0xBD, 0x45, 0xE2, 0xF4, 0xB6, 0x66, 0xCC, 0x95, 0x03, 0x56, 0xD4, 0x1C, 0x1E, 0xD7, 0xFB, 0xC3, 0x8E, 0xB5, 0xE9, 0xCF, 0xBF, 0xBA, 0xEA, 0x77, 0x39, 0xAF, 0x33, 0xC9, 0x62, 0x71, 0x81, 0x79, 0x09, 0xAD, 0x24, 0xCD, 0xF9, 0xD8, 0xE5, 0xC5, 0xB9, 0x4D, 0x44, 0x08, 0x86, 0xE7, 0xA1, 0x1D, 0xAA, 0xED, 0x06, 0x70, 0xB2, 0xD2, 0x41, 0x7B, 0xA0, 0x11, 0x31, 0xC2, 0x27, 0x90, 0x20, 0xF6, 0x60, 0xFF, 0x96, 0x5C, 0xB1, 0xAB, 0x9E, 0x9C, 0x52, 0x1B, 0x5F, 0x93, 0x0A, 0xEF, 0x91, 0x85, 0x49, 0xEE, 0x2D, 0x4F, 0x8F, 0x3B, 0x47, 0x87, 0x6D, 0x46, 0xD6, 0x3E, 0x69, 0x64, 0x2A, 0xCE, 0xCB, 0x2F, 0xFC, 0x97, 0x05, 0x7A, 0xAC, 0x7F, 0xD5, 0x1A, 0x4B, 0x0E, 0xA7, 0x5A, 0x28, 0x14, 0x3F, 0x29, 0x88, 0x3C, 0x4C, 0x02, 0xB8, 0xDA, 0xB0, 0x17, 0x55, 0x1F, 0x8A, 0x7D, 0x57, 0xC7, 0x8D, 0x74, 0xB7, 0xC4, 0x9F, 0x72, 0x7E, 0x15, 0x22, 0x12, 0x58, 0x07, 0x99, 0x34, 0x6E, 0x50, 0xDE, 0x68, 0x65, 0xBC, 0xDB, 0xF8, 0xC8, 0xA8, 0x2B, 0x40, 0xDC, 0xFE, 0x32, 0xA4, 0xCA, 0x10, 0x21, 0xF0, 0xD3, 0x5D, 0x0F, 0x00, 0x6F, 0x9D, 0x36, 0x42, 0x4A, 0x5E, 0xC1, 0xE0], [0x75, 0xF3, 0xC6, 0xF4, 0xDB, 0x7B, 0xFB, 0xC8, 0x4A, 0xD3, 0xE6, 0x6B, 0x45, 0x7D, 0xE8, 0x4B, 0xD6, 0x32, 0xD8, 0xFD, 0x37, 0x71, 0xF1, 0xE1, 0x30, 0x0F, 0xF8, 0x1B, 0x87, 0xFA, 0x06, 0x3F, 0x5E, 0xBA, 0xAE, 0x5B, 0x8A, 0x00, 0xBC, 0x9D, 0x6D, 0xC1, 0xB1, 0x0E, 0x80, 0x5D, 0xD2, 0xD5, 0xA0, 0x84, 0x07, 0x14, 0xB5, 0x90, 0x2C, 0xA3, 0xB2, 0x73, 0x4C, 0x54, 0x92, 0x74, 0x36, 0x51, 0x38, 0xB0, 0xBD, 0x5A, 0xFC, 0x60, 0x62, 0x96, 0x6C, 0x42, 0xF7, 0x10, 0x7C, 0x28, 0x27, 0x8C, 0x13, 0x95, 0x9C, 0xC7, 0x24, 0x46, 0x3B, 0x70, 0xCA, 0xE3, 0x85, 0xCB, 0x11, 0xD0, 0x93, 0xB8, 0xA6, 0x83, 0x20, 0xFF, 0x9F, 0x77, 0xC3, 0xCC, 0x03, 0x6F, 0x08, 0xBF, 0x40, 0xE7, 0x2B, 0xE2, 0x79, 0x0C, 0xAA, 0x82, 0x41, 0x3A, 0xEA, 0xB9, 0xE4, 0x9A, 0xA4, 0x97, 0x7E, 0xDA, 0x7A, 0x17, 0x66, 0x94, 0xA1, 0x1D, 0x3D, 0xF0, 0xDE, 0xB3, 0x0B, 0x72, 0xA7, 0x1C, 0xEF, 0xD1, 0x53, 0x3E, 0x8F, 0x33, 0x26, 0x5F, 0xEC, 0x76, 0x2A, 0x49, 0x81, 0x88, 0xEE, 0x21, 0xC4, 0x1A, 0xEB, 0xD9, 0xC5, 0x39, 0x99, 0xCD, 0xAD, 0x31, 0x8B, 0x01, 0x18, 0x23, 0xDD, 0x1F, 0x4E, 0x2D, 0xF9, 0x48, 0x4F, 0xF2, 0x65, 0x8E, 0x78, 0x5C, 0x58, 0x19, 0x8D, 0xE5, 0x98, 0x57, 0x67, 0x7F, 0x05, 0x64, 0xAF, 0x63, 0xB6, 0xFE, 0xF5, 0xB7, 0x3C, 0xA5, 0xCE, 0xE9, 0x68, 0x44, 0xE0, 0x4D, 0x43, 0x69, 0x29, 0x2E, 0xAC, 0x15, 0x59, 0xA8, 0x0A, 0x9E, 0x6E, 0x47, 0xDF, 0x34, 0x35, 0x6A, 0xCF, 0xDC, 0x22, 0xC9, 0xC0, 0x9B, 0x89, 0xD4, 0xED, 0xAB, 0x12, 0xA2, 0x0D, 0x52, 0xBB, 0x02, 0x2F, 0xA9, 0xD7, 0x61, 0x1E, 0xB4, 0x50, 0x04, 0xF6, 0xC2, 0x16, 0x25, 0x86, 0x56, 0x55, 0x09, 0xBE, 0x91]];\n      this.P_00 = 1;\n      this.P_01 = 0;\n      this.P_02 = 0;\n      this.P_03 = 1;\n      this.P_04 = 1;\n      this.P_10 = 0;\n      this.P_11 = 0;\n      this.P_12 = 1;\n      this.P_13 = 1;\n      this.P_14 = 0;\n      this.P_20 = 1;\n      this.P_21 = 1;\n      this.P_22 = 0;\n      this.P_23 = 0;\n      this.P_24 = 0;\n      this.P_30 = 0;\n      this.P_31 = 1;\n      this.P_32 = 1;\n      this.P_33 = 0;\n      this.P_34 = 1;\n      this.GF256_FDBK = 0x169;\n      this.GF256_FDBK_2 = this.GF256_FDBK / 2;\n      this.GF256_FDBK_4 = this.GF256_FDBK / 4;\n      this.RS_GF_FDBK = 0x14D;\n      this.SK_STEP = 0x02020202;\n      this.SK_BUMP = 0x01010101;\n      this.SK_ROTL = 9;\n    }\n\n    return Global;\n  }();\n\n  G = new Global();\n\n  exports.TwoFish = TwoFish = function (_super) {\n    __extends(TwoFish, _super);\n\n    TwoFish.blockSize = 4 * 4;\n    TwoFish.prototype.blockSize = TwoFish.blockSize;\n    TwoFish.keySize = 256 / 8;\n    TwoFish.prototype.keySize = TwoFish.keySize;\n    TwoFish.ivSize = TwoFish.blockSize;\n    TwoFish.prototype.ivSize = TwoFish.ivSize;\n\n    function TwoFish(key) {\n      this._key = key.clone();\n      this.gMDS0 = [];\n      this.gMDS1 = [];\n      this.gMDS2 = [];\n      this.gMDS3 = [];\n      this.gSubKeys = [];\n      this.gSBox = [];\n      this.k64Cnt = 0;\n\n      this._doReset();\n    }\n\n    TwoFish.prototype.getByte = function (x, n) {\n      return x >>> n * 8 & 0xFF;\n    };\n\n    TwoFish.prototype.switchEndianness = function (word) {\n      return (word & 0xff) << 24 | (word >> 8 & 0xff) << 16 | (word >> 16 & 0xff) << 8 | word >> 24 & 0xff;\n    };\n\n    TwoFish.prototype.LFSR1 = function (x) {\n      return x >> 1 ^ ((x & 0x01) !== 0 ? G.GF256_FDBK_2 : 0);\n    };\n\n    TwoFish.prototype.LFSR2 = function (x) {\n      return x >> 2 ^ ((x & 0x02) !== 0 ? G.GF256_FDBK_2 : 0) ^ ((x & 0x01) !== 0 ? G.GF256_FDBK_4 : 0);\n    };\n\n    TwoFish.prototype.Mx_X = function (x) {\n      return x ^ this.LFSR2(x);\n    };\n\n    TwoFish.prototype.Mx_Y = function (x) {\n      return x ^ this.LFSR1(x) ^ this.LFSR2(x);\n    };\n\n    TwoFish.prototype.RS_rem = function (x) {\n      var b, g2, g3;\n      b = x >>> 24 & 0xff;\n      g2 = (b << 1 ^ ((b & 0x80) !== 0 ? G.RS_GF_FDBK : 0)) & 0xff;\n      g3 = b >>> 1 ^ ((b & 0x01) !== 0 ? G.RS_GF_FDBK >>> 1 : 0) ^ g2;\n      return x << 8 ^ g3 << 24 ^ g2 << 16 ^ g3 << 8 ^ b;\n    };\n\n    TwoFish.prototype.RS_MDS_Encode = function (k0, k1) {\n      var i, r, _i, _j;\n\n      r = k1;\n\n      for (i = _i = 0; _i < 4; i = ++_i) {\n        r = this.RS_rem(r);\n      }\n\n      r ^= k0;\n\n      for (i = _j = 0; _j < 4; i = ++_j) {\n        r = this.RS_rem(r);\n      }\n\n      return r;\n    };\n\n    TwoFish.prototype.F32 = function (x, k32) {\n      var b0, b1, b2, b3, k0, k1, k2, k3, m, res;\n      b0 = this.getByte(x, 0);\n      b1 = this.getByte(x, 1);\n      b2 = this.getByte(x, 2);\n      b3 = this.getByte(x, 3);\n      k0 = k32[0];\n      k1 = k32[1];\n      k2 = k32[2];\n      k3 = k32[3];\n      m = this.k64Cnt & 3;\n      res = m === 1 ? this.gMDS0[G.P[G.P_01][b0] & 0xff ^ this.getByte(k0, 0)] ^ this.gMDS1[G.P[G.P_11][b1] & 0xff ^ this.getByte(k0, 1)] ^ this.gMDS2[G.P[G.P_21][b2] & 0xff ^ this.getByte(k0, 2)] ^ this.gMDS3[G.P[G.P_31][b3] & 0xff ^ this.getByte(k0, 3)] : (m === 0 ? (b0 = G.P[G.P_04][b0] & 0xff ^ this.getByte(k3, 0), b1 = G.P[G.P_14][b1] & 0xff ^ this.getByte(k3, 1), b2 = G.P[G.P_24][b2] & 0xff ^ this.getByte(k3, 2), b3 = G.P[G.P_34][b3] & 0xff ^ this.getByte(k3, 3)) : void 0, m === 0 || m === 3 ? (b0 = G.P[G.P_03][b0] & 0xff ^ this.getByte(k2, 0), b1 = G.P[G.P_13][b1] & 0xff ^ this.getByte(k2, 1), b2 = G.P[G.P_23][b2] & 0xff ^ this.getByte(k2, 2), b3 = G.P[G.P_33][b3] & 0xff ^ this.getByte(k2, 3)) : void 0, this.gMDS0[G.P[G.P_01][G.P[G.P_02][b0] & 0xff ^ this.getByte(k1, 0)] & 0xff ^ this.getByte(k0, 0)] ^ this.gMDS1[G.P[G.P_11][G.P[G.P_12][b1] & 0xff ^ this.getByte(k1, 1)] & 0xff ^ this.getByte(k0, 1)] ^ this.gMDS2[G.P[G.P_21][G.P[G.P_22][b2] & 0xff ^ this.getByte(k1, 2)] & 0xff ^ this.getByte(k0, 2)] ^ this.gMDS3[G.P[G.P_31][G.P[G.P_32][b3] & 0xff ^ this.getByte(k1, 3)] & 0xff ^ this.getByte(k0, 3)]);\n      return res;\n    };\n\n    TwoFish.prototype.Fe32_0 = function (x) {\n      return this.gSBox[0x000 + 2 * (x & 0xff)] ^ this.gSBox[0x001 + 2 * (x >>> 8 & 0xff)] ^ this.gSBox[0x200 + 2 * (x >>> 16 & 0xff)] ^ this.gSBox[0x201 + 2 * (x >>> 24 & 0xff)];\n    };\n\n    TwoFish.prototype.Fe32_3 = function (x) {\n      return this.gSBox[0x000 + 2 * (x >>> 24 & 0xff)] ^ this.gSBox[0x001 + 2 * (x & 0xff)] ^ this.gSBox[0x200 + 2 * (x >>> 8 & 0xff)] ^ this.gSBox[0x201 + 2 * (x >>> 16 & 0xff)];\n    };\n\n    TwoFish.prototype._doReset = function () {\n      var A, B, b0, b1, b2, b3, i, j, k0, k1, k2, k3, k32e, k32o, m, m1, mX, mY, p, q, sBoxKeys, _i, _j, _k, _l, _ref, _ref1, _results;\n\n      k32e = [];\n      k32o = [];\n      sBoxKeys = [];\n      m1 = [];\n      mX = [];\n      mY = [];\n      this.k64Cnt = this._key.words.length / 2;\n\n      if (this.k64Cnt < 1) {\n        throw \"Key size less than 64 bits\";\n      }\n\n      if (this.k64Cnt > 4) {\n        throw \"Key size larger than 256 bits\";\n      }\n\n      for (i = _i = 0; _i < 256; i = ++_i) {\n        j = G.P[0][i] & 0xff;\n        m1[0] = j;\n        mX[0] = this.Mx_X(j) & 0xff;\n        mY[0] = this.Mx_Y(j) & 0xff;\n        j = G.P[1][i] & 0xff;\n        m1[1] = j;\n        mX[1] = this.Mx_X(j) & 0xff;\n        mY[1] = this.Mx_Y(j) & 0xff;\n        this.gMDS0[i] = m1[G.P_00] | mX[G.P_00] << 8 | mY[G.P_00] << 16 | mY[G.P_00] << 24;\n        this.gMDS1[i] = mY[G.P_10] | mY[G.P_10] << 8 | mX[G.P_10] << 16 | m1[G.P_10] << 24;\n        this.gMDS2[i] = mX[G.P_20] | mY[G.P_20] << 8 | m1[G.P_20] << 16 | mY[G.P_20] << 24;\n        this.gMDS3[i] = mX[G.P_30] | m1[G.P_30] << 8 | mY[G.P_30] << 16 | mX[G.P_30] << 24;\n      }\n\n      for (i = _j = 0, _ref = this.k64Cnt; 0 <= _ref ? _j < _ref : _j > _ref; i = 0 <= _ref ? ++_j : --_j) {\n        p = i * 2;\n        k32e[i] = this.switchEndianness(this._key.words[p]);\n        k32o[i] = this.switchEndianness(this._key.words[p + 1]);\n        sBoxKeys[this.k64Cnt - 1 - i] = this.RS_MDS_Encode(k32e[i], k32o[i]);\n      }\n\n      for (i = _k = 0, _ref1 = 40 / 2; 0 <= _ref1 ? _k < _ref1 : _k > _ref1; i = 0 <= _ref1 ? ++_k : --_k) {\n        q = i * G.SK_STEP;\n        A = this.F32(q, k32e);\n        B = this.F32(q + G.SK_BUMP, k32o);\n        B = B << 8 | B >>> 24;\n        A += B;\n        this.gSubKeys[i * 2] = A;\n        A += B;\n        this.gSubKeys[i * 2 + 1] = A << G.SK_ROTL | A >>> 32 - G.SK_ROTL;\n      }\n\n      k0 = sBoxKeys[0];\n      k1 = sBoxKeys[1];\n      k2 = sBoxKeys[2];\n      k3 = sBoxKeys[3];\n      this.gSBox = [];\n      _results = [];\n\n      for (i = _l = 0; _l < 256; i = ++_l) {\n        b0 = b1 = b2 = b3 = i;\n        m = this.k64Cnt & 3;\n\n        if (m === 1) {\n          this.gSBox[i * 2] = this.gMDS0[G.P[G.P_01][b0] & 0xff ^ this.getByte(k0, 0)];\n          this.gSBox[i * 2 + 1] = this.gMDS1[G.P[G.P_11][b1] & 0xff ^ this.getByte(k0, 1)];\n          this.gSBox[i * 2 + 0x200] = this.gMDS2[G.P[G.P_21][b2] & 0xff ^ this.getByte(k0, 2)];\n\n          _results.push(this.gSBox[i * 2 + 0x201] = this.gMDS3[G.P[G.P_31][b3] & 0xff ^ this.getByte(k0, 3)]);\n        } else {\n          if (m === 0) {\n            b0 = G.P[G.P_04][b0] & 0xff ^ this.getByte(k3, 0);\n            b1 = G.P[G.P_14][b1] & 0xff ^ this.getByte(k3, 1);\n            b2 = G.P[G.P_24][b2] & 0xff ^ this.getByte(k3, 2);\n            b3 = G.P[G.P_34][b3] & 0xff ^ this.getByte(k3, 3);\n          }\n\n          if (m === 0 || m === 3) {\n            b0 = G.P[G.P_03][b0] & 0xff ^ this.getByte(k2, 0);\n            b1 = G.P[G.P_13][b1] & 0xff ^ this.getByte(k2, 1);\n            b2 = G.P[G.P_23][b2] & 0xff ^ this.getByte(k2, 2);\n            b3 = G.P[G.P_33][b3] & 0xff ^ this.getByte(k2, 3);\n          }\n\n          this.gSBox[i * 2] = this.gMDS0[G.P[G.P_01][G.P[G.P_02][b0] & 0xff ^ this.getByte(k1, 0)] & 0xff ^ this.getByte(k0, 0)];\n          this.gSBox[i * 2 + 1] = this.gMDS1[G.P[G.P_11][G.P[G.P_12][b1] & 0xff ^ this.getByte(k1, 1)] & 0xff ^ this.getByte(k0, 1)];\n          this.gSBox[i * 2 + 0x200] = this.gMDS2[G.P[G.P_21][G.P[G.P_22][b2] & 0xff ^ this.getByte(k1, 2)] & 0xff ^ this.getByte(k0, 2)];\n\n          _results.push(this.gSBox[i * 2 + 0x201] = this.gMDS3[G.P[G.P_31][G.P[G.P_32][b3] & 0xff ^ this.getByte(k1, 3)] & 0xff ^ this.getByte(k0, 3)]);\n        }\n      }\n\n      return _results;\n    };\n\n    TwoFish.prototype.scrub = function () {\n      scrub_vec(this.gSubKeys);\n      scrub_vec(this.gSBox);\n      return this._key.scrub();\n    };\n\n    TwoFish.prototype.decryptBlock = function (M, offset) {\n      var k, r, t0, t1, x0, x1, x2, x3, _i;\n\n      if (offset == null) {\n        offset = 0;\n      }\n\n      x2 = this.switchEndianness(M[offset]) ^ this.gSubKeys[4];\n      x3 = this.switchEndianness(M[offset + 1]) ^ this.gSubKeys[5];\n      x0 = this.switchEndianness(M[offset + 2]) ^ this.gSubKeys[6];\n      x1 = this.switchEndianness(M[offset + 3]) ^ this.gSubKeys[7];\n      k = 8 + 2 * 16 - 1;\n\n      for (r = _i = 0; _i < 16; r = _i += 2) {\n        t0 = this.Fe32_0(x2);\n        t1 = this.Fe32_3(x3);\n        x1 ^= t0 + 2 * t1 + this.gSubKeys[k--];\n        x0 = (x0 << 1 | x0 >>> 31) ^ t0 + t1 + this.gSubKeys[k--];\n        x1 = x1 >>> 1 | x1 << 31;\n        t0 = this.Fe32_0(x0);\n        t1 = this.Fe32_3(x1);\n        x3 ^= t0 + 2 * t1 + this.gSubKeys[k--];\n        x2 = (x2 << 1 | x2 >>> 31) ^ t0 + t1 + this.gSubKeys[k--];\n        x3 = x3 >>> 1 | x3 << 31;\n      }\n\n      M[offset] = this.switchEndianness(x0 ^ this.gSubKeys[0]);\n      M[offset + 1] = this.switchEndianness(x1 ^ this.gSubKeys[1]);\n      M[offset + 2] = this.switchEndianness(x2 ^ this.gSubKeys[2]);\n      return M[offset + 3] = this.switchEndianness(x3 ^ this.gSubKeys[3]);\n    };\n\n    TwoFish.prototype.encryptBlock = function (M, offset) {\n      var k, r, t0, t1, x0, x1, x2, x3, _i;\n\n      if (offset == null) {\n        offset = 0;\n      }\n\n      x0 = this.switchEndianness(M[offset]) ^ this.gSubKeys[0];\n      x1 = this.switchEndianness(M[offset + 1]) ^ this.gSubKeys[1];\n      x2 = this.switchEndianness(M[offset + 2]) ^ this.gSubKeys[2];\n      x3 = this.switchEndianness(M[offset + 3]) ^ this.gSubKeys[3];\n      k = 8;\n\n      for (r = _i = 0; _i < 16; r = _i += 2) {\n        t0 = this.Fe32_0(x0);\n        t1 = this.Fe32_3(x1);\n        x2 ^= t0 + t1 + this.gSubKeys[k++];\n        x2 = x2 >>> 1 | x2 << 31;\n        x3 = (x3 << 1 | x3 >>> 31) ^ t0 + 2 * t1 + this.gSubKeys[k++];\n        t0 = this.Fe32_0(x2);\n        t1 = this.Fe32_3(x3);\n        x0 ^= t0 + t1 + this.gSubKeys[k++];\n        x0 = x0 >>> 1 | x0 << 31;\n        x1 = (x1 << 1 | x1 >>> 31) ^ t0 + 2 * t1 + this.gSubKeys[k++];\n      }\n\n      M[offset] = this.switchEndianness(x2 ^ this.gSubKeys[4]);\n      M[offset + 1] = this.switchEndianness(x3 ^ this.gSubKeys[5]);\n      M[offset + 2] = this.switchEndianness(x0 ^ this.gSubKeys[6]);\n      return M[offset + 3] = this.switchEndianness(x1 ^ this.gSubKeys[7]);\n    };\n\n    return TwoFish;\n  }(BlockCipher);\n}).call(this);","map":{"version":3,"sources":["/home/os/Desktop/hello-world-tutorial/node_modules/triplesec/lib/twofish.js"],"names":["BlockCipher","G","Global","TwoFish","scrub_vec","__hasProp","hasOwnProperty","__extends","child","parent","key","call","ctor","constructor","prototype","__super__","require","P","P_00","P_01","P_02","P_03","P_04","P_10","P_11","P_12","P_13","P_14","P_20","P_21","P_22","P_23","P_24","P_30","P_31","P_32","P_33","P_34","GF256_FDBK","GF256_FDBK_2","GF256_FDBK_4","RS_GF_FDBK","SK_STEP","SK_BUMP","SK_ROTL","exports","_super","blockSize","keySize","ivSize","_key","clone","gMDS0","gMDS1","gMDS2","gMDS3","gSubKeys","gSBox","k64Cnt","_doReset","getByte","x","n","switchEndianness","word","LFSR1","LFSR2","Mx_X","Mx_Y","RS_rem","b","g2","g3","RS_MDS_Encode","k0","k1","i","r","_i","_j","F32","k32","b0","b1","b2","b3","k2","k3","m","res","Fe32_0","Fe32_3","A","B","j","k32e","k32o","m1","mX","mY","p","q","sBoxKeys","_k","_l","_ref","_ref1","_results","words","length","push","scrub","decryptBlock","M","offset","k","t0","t1","x0","x1","x2","x3","encryptBlock"],"mappings":"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","sourcesContent":["// Generated by IcedCoffeeScript 108.0.8\n(function() {\n  var BlockCipher, G, Global, TwoFish, scrub_vec,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  BlockCipher = require('./algbase').BlockCipher;\n\n  scrub_vec = require('./util').scrub_vec;\n\n  Global = (function() {\n    function Global() {\n      this.P = [[0xA9, 0x67, 0xB3, 0xE8, 0x04, 0xFD, 0xA3, 0x76, 0x9A, 0x92, 0x80, 0x78, 0xE4, 0xDD, 0xD1, 0x38, 0x0D, 0xC6, 0x35, 0x98, 0x18, 0xF7, 0xEC, 0x6C, 0x43, 0x75, 0x37, 0x26, 0xFA, 0x13, 0x94, 0x48, 0xF2, 0xD0, 0x8B, 0x30, 0x84, 0x54, 0xDF, 0x23, 0x19, 0x5B, 0x3D, 0x59, 0xF3, 0xAE, 0xA2, 0x82, 0x63, 0x01, 0x83, 0x2E, 0xD9, 0x51, 0x9B, 0x7C, 0xA6, 0xEB, 0xA5, 0xBE, 0x16, 0x0C, 0xE3, 0x61, 0xC0, 0x8C, 0x3A, 0xF5, 0x73, 0x2C, 0x25, 0x0B, 0xBB, 0x4E, 0x89, 0x6B, 0x53, 0x6A, 0xB4, 0xF1, 0xE1, 0xE6, 0xBD, 0x45, 0xE2, 0xF4, 0xB6, 0x66, 0xCC, 0x95, 0x03, 0x56, 0xD4, 0x1C, 0x1E, 0xD7, 0xFB, 0xC3, 0x8E, 0xB5, 0xE9, 0xCF, 0xBF, 0xBA, 0xEA, 0x77, 0x39, 0xAF, 0x33, 0xC9, 0x62, 0x71, 0x81, 0x79, 0x09, 0xAD, 0x24, 0xCD, 0xF9, 0xD8, 0xE5, 0xC5, 0xB9, 0x4D, 0x44, 0x08, 0x86, 0xE7, 0xA1, 0x1D, 0xAA, 0xED, 0x06, 0x70, 0xB2, 0xD2, 0x41, 0x7B, 0xA0, 0x11, 0x31, 0xC2, 0x27, 0x90, 0x20, 0xF6, 0x60, 0xFF, 0x96, 0x5C, 0xB1, 0xAB, 0x9E, 0x9C, 0x52, 0x1B, 0x5F, 0x93, 0x0A, 0xEF, 0x91, 0x85, 0x49, 0xEE, 0x2D, 0x4F, 0x8F, 0x3B, 0x47, 0x87, 0x6D, 0x46, 0xD6, 0x3E, 0x69, 0x64, 0x2A, 0xCE, 0xCB, 0x2F, 0xFC, 0x97, 0x05, 0x7A, 0xAC, 0x7F, 0xD5, 0x1A, 0x4B, 0x0E, 0xA7, 0x5A, 0x28, 0x14, 0x3F, 0x29, 0x88, 0x3C, 0x4C, 0x02, 0xB8, 0xDA, 0xB0, 0x17, 0x55, 0x1F, 0x8A, 0x7D, 0x57, 0xC7, 0x8D, 0x74, 0xB7, 0xC4, 0x9F, 0x72, 0x7E, 0x15, 0x22, 0x12, 0x58, 0x07, 0x99, 0x34, 0x6E, 0x50, 0xDE, 0x68, 0x65, 0xBC, 0xDB, 0xF8, 0xC8, 0xA8, 0x2B, 0x40, 0xDC, 0xFE, 0x32, 0xA4, 0xCA, 0x10, 0x21, 0xF0, 0xD3, 0x5D, 0x0F, 0x00, 0x6F, 0x9D, 0x36, 0x42, 0x4A, 0x5E, 0xC1, 0xE0], [0x75, 0xF3, 0xC6, 0xF4, 0xDB, 0x7B, 0xFB, 0xC8, 0x4A, 0xD3, 0xE6, 0x6B, 0x45, 0x7D, 0xE8, 0x4B, 0xD6, 0x32, 0xD8, 0xFD, 0x37, 0x71, 0xF1, 0xE1, 0x30, 0x0F, 0xF8, 0x1B, 0x87, 0xFA, 0x06, 0x3F, 0x5E, 0xBA, 0xAE, 0x5B, 0x8A, 0x00, 0xBC, 0x9D, 0x6D, 0xC1, 0xB1, 0x0E, 0x80, 0x5D, 0xD2, 0xD5, 0xA0, 0x84, 0x07, 0x14, 0xB5, 0x90, 0x2C, 0xA3, 0xB2, 0x73, 0x4C, 0x54, 0x92, 0x74, 0x36, 0x51, 0x38, 0xB0, 0xBD, 0x5A, 0xFC, 0x60, 0x62, 0x96, 0x6C, 0x42, 0xF7, 0x10, 0x7C, 0x28, 0x27, 0x8C, 0x13, 0x95, 0x9C, 0xC7, 0x24, 0x46, 0x3B, 0x70, 0xCA, 0xE3, 0x85, 0xCB, 0x11, 0xD0, 0x93, 0xB8, 0xA6, 0x83, 0x20, 0xFF, 0x9F, 0x77, 0xC3, 0xCC, 0x03, 0x6F, 0x08, 0xBF, 0x40, 0xE7, 0x2B, 0xE2, 0x79, 0x0C, 0xAA, 0x82, 0x41, 0x3A, 0xEA, 0xB9, 0xE4, 0x9A, 0xA4, 0x97, 0x7E, 0xDA, 0x7A, 0x17, 0x66, 0x94, 0xA1, 0x1D, 0x3D, 0xF0, 0xDE, 0xB3, 0x0B, 0x72, 0xA7, 0x1C, 0xEF, 0xD1, 0x53, 0x3E, 0x8F, 0x33, 0x26, 0x5F, 0xEC, 0x76, 0x2A, 0x49, 0x81, 0x88, 0xEE, 0x21, 0xC4, 0x1A, 0xEB, 0xD9, 0xC5, 0x39, 0x99, 0xCD, 0xAD, 0x31, 0x8B, 0x01, 0x18, 0x23, 0xDD, 0x1F, 0x4E, 0x2D, 0xF9, 0x48, 0x4F, 0xF2, 0x65, 0x8E, 0x78, 0x5C, 0x58, 0x19, 0x8D, 0xE5, 0x98, 0x57, 0x67, 0x7F, 0x05, 0x64, 0xAF, 0x63, 0xB6, 0xFE, 0xF5, 0xB7, 0x3C, 0xA5, 0xCE, 0xE9, 0x68, 0x44, 0xE0, 0x4D, 0x43, 0x69, 0x29, 0x2E, 0xAC, 0x15, 0x59, 0xA8, 0x0A, 0x9E, 0x6E, 0x47, 0xDF, 0x34, 0x35, 0x6A, 0xCF, 0xDC, 0x22, 0xC9, 0xC0, 0x9B, 0x89, 0xD4, 0xED, 0xAB, 0x12, 0xA2, 0x0D, 0x52, 0xBB, 0x02, 0x2F, 0xA9, 0xD7, 0x61, 0x1E, 0xB4, 0x50, 0x04, 0xF6, 0xC2, 0x16, 0x25, 0x86, 0x56, 0x55, 0x09, 0xBE, 0x91]];\n      this.P_00 = 1;\n      this.P_01 = 0;\n      this.P_02 = 0;\n      this.P_03 = 1;\n      this.P_04 = 1;\n      this.P_10 = 0;\n      this.P_11 = 0;\n      this.P_12 = 1;\n      this.P_13 = 1;\n      this.P_14 = 0;\n      this.P_20 = 1;\n      this.P_21 = 1;\n      this.P_22 = 0;\n      this.P_23 = 0;\n      this.P_24 = 0;\n      this.P_30 = 0;\n      this.P_31 = 1;\n      this.P_32 = 1;\n      this.P_33 = 0;\n      this.P_34 = 1;\n      this.GF256_FDBK = 0x169;\n      this.GF256_FDBK_2 = this.GF256_FDBK / 2;\n      this.GF256_FDBK_4 = this.GF256_FDBK / 4;\n      this.RS_GF_FDBK = 0x14D;\n      this.SK_STEP = 0x02020202;\n      this.SK_BUMP = 0x01010101;\n      this.SK_ROTL = 9;\n    }\n\n    return Global;\n\n  })();\n\n  G = new Global();\n\n  exports.TwoFish = TwoFish = (function(_super) {\n    __extends(TwoFish, _super);\n\n    TwoFish.blockSize = 4 * 4;\n\n    TwoFish.prototype.blockSize = TwoFish.blockSize;\n\n    TwoFish.keySize = 256 / 8;\n\n    TwoFish.prototype.keySize = TwoFish.keySize;\n\n    TwoFish.ivSize = TwoFish.blockSize;\n\n    TwoFish.prototype.ivSize = TwoFish.ivSize;\n\n    function TwoFish(key) {\n      this._key = key.clone();\n      this.gMDS0 = [];\n      this.gMDS1 = [];\n      this.gMDS2 = [];\n      this.gMDS3 = [];\n      this.gSubKeys = [];\n      this.gSBox = [];\n      this.k64Cnt = 0;\n      this._doReset();\n    }\n\n    TwoFish.prototype.getByte = function(x, n) {\n      return (x >>> (n * 8)) & 0xFF;\n    };\n\n    TwoFish.prototype.switchEndianness = function(word) {\n      return ((word & 0xff) << 24) | (((word >> 8) & 0xff) << 16) | (((word >> 16) & 0xff) << 8) | ((word >> 24) & 0xff);\n    };\n\n    TwoFish.prototype.LFSR1 = function(x) {\n      return (x >> 1) ^ ((x & 0x01) !== 0 ? G.GF256_FDBK_2 : 0);\n    };\n\n    TwoFish.prototype.LFSR2 = function(x) {\n      return (x >> 2) ^ ((x & 0x02) !== 0 ? G.GF256_FDBK_2 : 0) ^ ((x & 0x01) !== 0 ? G.GF256_FDBK_4 : 0);\n    };\n\n    TwoFish.prototype.Mx_X = function(x) {\n      return x ^ this.LFSR2(x);\n    };\n\n    TwoFish.prototype.Mx_Y = function(x) {\n      return x ^ this.LFSR1(x) ^ this.LFSR2(x);\n    };\n\n    TwoFish.prototype.RS_rem = function(x) {\n      var b, g2, g3;\n      b = (x >>> 24) & 0xff;\n      g2 = ((b << 1) ^ ((b & 0x80) !== 0 ? G.RS_GF_FDBK : 0)) & 0xff;\n      g3 = ((b >>> 1) ^ ((b & 0x01) !== 0 ? G.RS_GF_FDBK >>> 1 : 0)) ^ g2;\n      return (x << 8) ^ (g3 << 24) ^ (g2 << 16) ^ (g3 << 8) ^ b;\n    };\n\n    TwoFish.prototype.RS_MDS_Encode = function(k0, k1) {\n      var i, r, _i, _j;\n      r = k1;\n      for (i = _i = 0; _i < 4; i = ++_i) {\n        r = this.RS_rem(r);\n      }\n      r ^= k0;\n      for (i = _j = 0; _j < 4; i = ++_j) {\n        r = this.RS_rem(r);\n      }\n      return r;\n    };\n\n    TwoFish.prototype.F32 = function(x, k32) {\n      var b0, b1, b2, b3, k0, k1, k2, k3, m, res;\n      b0 = this.getByte(x, 0);\n      b1 = this.getByte(x, 1);\n      b2 = this.getByte(x, 2);\n      b3 = this.getByte(x, 3);\n      k0 = k32[0];\n      k1 = k32[1];\n      k2 = k32[2];\n      k3 = k32[3];\n      m = this.k64Cnt & 3;\n      res = m === 1 ? this.gMDS0[(G.P[G.P_01][b0] & 0xff) ^ this.getByte(k0, 0)] ^ this.gMDS1[(G.P[G.P_11][b1] & 0xff) ^ this.getByte(k0, 1)] ^ this.gMDS2[(G.P[G.P_21][b2] & 0xff) ^ this.getByte(k0, 2)] ^ this.gMDS3[(G.P[G.P_31][b3] & 0xff) ^ this.getByte(k0, 3)] : (m === 0 ? (b0 = (G.P[G.P_04][b0] & 0xff) ^ this.getByte(k3, 0), b1 = (G.P[G.P_14][b1] & 0xff) ^ this.getByte(k3, 1), b2 = (G.P[G.P_24][b2] & 0xff) ^ this.getByte(k3, 2), b3 = (G.P[G.P_34][b3] & 0xff) ^ this.getByte(k3, 3)) : void 0, m === 0 || m === 3 ? (b0 = (G.P[G.P_03][b0] & 0xff) ^ this.getByte(k2, 0), b1 = (G.P[G.P_13][b1] & 0xff) ^ this.getByte(k2, 1), b2 = (G.P[G.P_23][b2] & 0xff) ^ this.getByte(k2, 2), b3 = (G.P[G.P_33][b3] & 0xff) ^ this.getByte(k2, 3)) : void 0, this.gMDS0[(G.P[G.P_01][(G.P[G.P_02][b0] & 0xff) ^ this.getByte(k1, 0)] & 0xff) ^ this.getByte(k0, 0)] ^ this.gMDS1[(G.P[G.P_11][(G.P[G.P_12][b1] & 0xff) ^ this.getByte(k1, 1)] & 0xff) ^ this.getByte(k0, 1)] ^ this.gMDS2[(G.P[G.P_21][(G.P[G.P_22][b2] & 0xff) ^ this.getByte(k1, 2)] & 0xff) ^ this.getByte(k0, 2)] ^ this.gMDS3[(G.P[G.P_31][(G.P[G.P_32][b3] & 0xff) ^ this.getByte(k1, 3)] & 0xff) ^ this.getByte(k0, 3)]);\n      return res;\n    };\n\n    TwoFish.prototype.Fe32_0 = function(x) {\n      return this.gSBox[0x000 + 2 * (x & 0xff)] ^ this.gSBox[0x001 + 2 * ((x >>> 8) & 0xff)] ^ this.gSBox[0x200 + 2 * ((x >>> 16) & 0xff)] ^ this.gSBox[0x201 + 2 * ((x >>> 24) & 0xff)];\n    };\n\n    TwoFish.prototype.Fe32_3 = function(x) {\n      return this.gSBox[0x000 + 2 * ((x >>> 24) & 0xff)] ^ this.gSBox[0x001 + 2 * (x & 0xff)] ^ this.gSBox[0x200 + 2 * ((x >>> 8) & 0xff)] ^ this.gSBox[0x201 + 2 * ((x >>> 16) & 0xff)];\n    };\n\n    TwoFish.prototype._doReset = function() {\n      var A, B, b0, b1, b2, b3, i, j, k0, k1, k2, k3, k32e, k32o, m, m1, mX, mY, p, q, sBoxKeys, _i, _j, _k, _l, _ref, _ref1, _results;\n      k32e = [];\n      k32o = [];\n      sBoxKeys = [];\n      m1 = [];\n      mX = [];\n      mY = [];\n      this.k64Cnt = this._key.words.length / 2;\n      if (this.k64Cnt < 1) {\n        throw \"Key size less than 64 bits\";\n      }\n      if (this.k64Cnt > 4) {\n        throw \"Key size larger than 256 bits\";\n      }\n      for (i = _i = 0; _i < 256; i = ++_i) {\n        j = G.P[0][i] & 0xff;\n        m1[0] = j;\n        mX[0] = this.Mx_X(j) & 0xff;\n        mY[0] = this.Mx_Y(j) & 0xff;\n        j = G.P[1][i] & 0xff;\n        m1[1] = j;\n        mX[1] = this.Mx_X(j) & 0xff;\n        mY[1] = this.Mx_Y(j) & 0xff;\n        this.gMDS0[i] = m1[G.P_00] | mX[G.P_00] << 8 | mY[G.P_00] << 16 | mY[G.P_00] << 24;\n        this.gMDS1[i] = mY[G.P_10] | mY[G.P_10] << 8 | mX[G.P_10] << 16 | m1[G.P_10] << 24;\n        this.gMDS2[i] = mX[G.P_20] | mY[G.P_20] << 8 | m1[G.P_20] << 16 | mY[G.P_20] << 24;\n        this.gMDS3[i] = mX[G.P_30] | m1[G.P_30] << 8 | mY[G.P_30] << 16 | mX[G.P_30] << 24;\n      }\n      for (i = _j = 0, _ref = this.k64Cnt; 0 <= _ref ? _j < _ref : _j > _ref; i = 0 <= _ref ? ++_j : --_j) {\n        p = i * 2;\n        k32e[i] = this.switchEndianness(this._key.words[p]);\n        k32o[i] = this.switchEndianness(this._key.words[p + 1]);\n        sBoxKeys[this.k64Cnt - 1 - i] = this.RS_MDS_Encode(k32e[i], k32o[i]);\n      }\n      for (i = _k = 0, _ref1 = 40 / 2; 0 <= _ref1 ? _k < _ref1 : _k > _ref1; i = 0 <= _ref1 ? ++_k : --_k) {\n        q = i * G.SK_STEP;\n        A = this.F32(q, k32e);\n        B = this.F32(q + G.SK_BUMP, k32o);\n        B = B << 8 | B >>> 24;\n        A += B;\n        this.gSubKeys[i * 2] = A;\n        A += B;\n        this.gSubKeys[i * 2 + 1] = A << G.SK_ROTL | A >>> (32 - G.SK_ROTL);\n      }\n      k0 = sBoxKeys[0];\n      k1 = sBoxKeys[1];\n      k2 = sBoxKeys[2];\n      k3 = sBoxKeys[3];\n      this.gSBox = [];\n      _results = [];\n      for (i = _l = 0; _l < 256; i = ++_l) {\n        b0 = b1 = b2 = b3 = i;\n        m = this.k64Cnt & 3;\n        if (m === 1) {\n          this.gSBox[i * 2] = this.gMDS0[(G.P[G.P_01][b0] & 0xff) ^ this.getByte(k0, 0)];\n          this.gSBox[i * 2 + 1] = this.gMDS1[(G.P[G.P_11][b1] & 0xff) ^ this.getByte(k0, 1)];\n          this.gSBox[i * 2 + 0x200] = this.gMDS2[(G.P[G.P_21][b2] & 0xff) ^ this.getByte(k0, 2)];\n          _results.push(this.gSBox[i * 2 + 0x201] = this.gMDS3[(G.P[G.P_31][b3] & 0xff) ^ this.getByte(k0, 3)]);\n        } else {\n          if (m === 0) {\n            b0 = (G.P[G.P_04][b0] & 0xff) ^ this.getByte(k3, 0);\n            b1 = (G.P[G.P_14][b1] & 0xff) ^ this.getByte(k3, 1);\n            b2 = (G.P[G.P_24][b2] & 0xff) ^ this.getByte(k3, 2);\n            b3 = (G.P[G.P_34][b3] & 0xff) ^ this.getByte(k3, 3);\n          }\n          if (m === 0 || m === 3) {\n            b0 = (G.P[G.P_03][b0] & 0xff) ^ this.getByte(k2, 0);\n            b1 = (G.P[G.P_13][b1] & 0xff) ^ this.getByte(k2, 1);\n            b2 = (G.P[G.P_23][b2] & 0xff) ^ this.getByte(k2, 2);\n            b3 = (G.P[G.P_33][b3] & 0xff) ^ this.getByte(k2, 3);\n          }\n          this.gSBox[i * 2] = this.gMDS0[(G.P[G.P_01][(G.P[G.P_02][b0] & 0xff) ^ this.getByte(k1, 0)] & 0xff) ^ this.getByte(k0, 0)];\n          this.gSBox[i * 2 + 1] = this.gMDS1[(G.P[G.P_11][(G.P[G.P_12][b1] & 0xff) ^ this.getByte(k1, 1)] & 0xff) ^ this.getByte(k0, 1)];\n          this.gSBox[i * 2 + 0x200] = this.gMDS2[(G.P[G.P_21][(G.P[G.P_22][b2] & 0xff) ^ this.getByte(k1, 2)] & 0xff) ^ this.getByte(k0, 2)];\n          _results.push(this.gSBox[i * 2 + 0x201] = this.gMDS3[(G.P[G.P_31][(G.P[G.P_32][b3] & 0xff) ^ this.getByte(k1, 3)] & 0xff) ^ this.getByte(k0, 3)]);\n        }\n      }\n      return _results;\n    };\n\n    TwoFish.prototype.scrub = function() {\n      scrub_vec(this.gSubKeys);\n      scrub_vec(this.gSBox);\n      return this._key.scrub();\n    };\n\n    TwoFish.prototype.decryptBlock = function(M, offset) {\n      var k, r, t0, t1, x0, x1, x2, x3, _i;\n      if (offset == null) {\n        offset = 0;\n      }\n      x2 = this.switchEndianness(M[offset]) ^ this.gSubKeys[4];\n      x3 = this.switchEndianness(M[offset + 1]) ^ this.gSubKeys[5];\n      x0 = this.switchEndianness(M[offset + 2]) ^ this.gSubKeys[6];\n      x1 = this.switchEndianness(M[offset + 3]) ^ this.gSubKeys[7];\n      k = 8 + 2 * 16 - 1;\n      for (r = _i = 0; _i < 16; r = _i += 2) {\n        t0 = this.Fe32_0(x2);\n        t1 = this.Fe32_3(x3);\n        x1 ^= t0 + 2 * t1 + this.gSubKeys[k--];\n        x0 = (x0 << 1 | x0 >>> 31) ^ (t0 + t1 + this.gSubKeys[k--]);\n        x1 = x1 >>> 1 | x1 << 31;\n        t0 = this.Fe32_0(x0);\n        t1 = this.Fe32_3(x1);\n        x3 ^= t0 + 2 * t1 + this.gSubKeys[k--];\n        x2 = (x2 << 1 | x2 >>> 31) ^ (t0 + t1 + this.gSubKeys[k--]);\n        x3 = x3 >>> 1 | x3 << 31;\n      }\n      M[offset] = this.switchEndianness(x0 ^ this.gSubKeys[0]);\n      M[offset + 1] = this.switchEndianness(x1 ^ this.gSubKeys[1]);\n      M[offset + 2] = this.switchEndianness(x2 ^ this.gSubKeys[2]);\n      return M[offset + 3] = this.switchEndianness(x3 ^ this.gSubKeys[3]);\n    };\n\n    TwoFish.prototype.encryptBlock = function(M, offset) {\n      var k, r, t0, t1, x0, x1, x2, x3, _i;\n      if (offset == null) {\n        offset = 0;\n      }\n      x0 = this.switchEndianness(M[offset]) ^ this.gSubKeys[0];\n      x1 = this.switchEndianness(M[offset + 1]) ^ this.gSubKeys[1];\n      x2 = this.switchEndianness(M[offset + 2]) ^ this.gSubKeys[2];\n      x3 = this.switchEndianness(M[offset + 3]) ^ this.gSubKeys[3];\n      k = 8;\n      for (r = _i = 0; _i < 16; r = _i += 2) {\n        t0 = this.Fe32_0(x0);\n        t1 = this.Fe32_3(x1);\n        x2 ^= t0 + t1 + this.gSubKeys[k++];\n        x2 = x2 >>> 1 | x2 << 31;\n        x3 = (x3 << 1 | x3 >>> 31) ^ (t0 + 2 * t1 + this.gSubKeys[k++]);\n        t0 = this.Fe32_0(x2);\n        t1 = this.Fe32_3(x3);\n        x0 ^= t0 + t1 + this.gSubKeys[k++];\n        x0 = x0 >>> 1 | x0 << 31;\n        x1 = (x1 << 1 | x1 >>> 31) ^ (t0 + 2 * t1 + this.gSubKeys[k++]);\n      }\n      M[offset] = this.switchEndianness(x2 ^ this.gSubKeys[4]);\n      M[offset + 1] = this.switchEndianness(x3 ^ this.gSubKeys[5]);\n      M[offset + 2] = this.switchEndianness(x0 ^ this.gSubKeys[6]);\n      return M[offset + 3] = this.switchEndianness(x1 ^ this.gSubKeys[7]);\n    };\n\n    return TwoFish;\n\n  })(BlockCipher);\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}