{"ast":null,"code":"// Generated by IcedCoffeeScript 108.0.8\n(function () {\n  var AES,\n      Base,\n      Concat,\n      Decryptor,\n      SHA512,\n      Salsa20,\n      TwoFish,\n      V,\n      WordArray,\n      ctr,\n      decrypt,\n      iced,\n      make_esc,\n      salsa20,\n      __iced_k,\n      __iced_k_noop,\n      _ref,\n      __hasProp = {}.hasOwnProperty,\n      __extends = function (child, parent) {\n    for (var key in parent) {\n      if (__hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  };\n\n  iced = require('iced-runtime');\n\n  __iced_k = __iced_k_noop = function () {};\n\n  WordArray = require('./wordarray').WordArray;\n  salsa20 = require('./salsa20');\n  AES = require('./aes').AES;\n  TwoFish = require('./twofish').TwoFish;\n  ctr = require('./ctr');\n  Concat = require('./combine').Concat;\n  SHA512 = require('./sha512').SHA512;\n  Salsa20 = require('./salsa20').Salsa20;\n  _ref = require('./enc'), Base = _ref.Base, V = _ref.V;\n  make_esc = require('iced-error').make_esc;\n\n  Decryptor = function (_super) {\n    __extends(Decryptor, _super);\n\n    function Decryptor(_arg) {\n      var enc, key;\n      key = _arg.key, enc = _arg.enc;\n\n      Decryptor.__super__.constructor.call(this, {\n        key: key\n      });\n\n      if (enc != null) {\n        this.key = enc.key;\n        this.derived_keys = enc.derived_keys;\n      }\n    }\n\n    Decryptor.prototype.read_header = function (cb) {\n      var err, wa;\n      err = (wa = this.ct.unshift(2)) == null ? new Error(\"Ciphertext underrun in header\") : (this.version = V[wa.words[1]]) == null ? new Error(\"bad header; couldn't find a good version (got \" + wa.words[1] + \")\") : wa.words[0] !== this.version.header[0] ? new Error(\"Bad header: unrecognized magic value\") : null;\n      return cb(err);\n    };\n\n    Decryptor.prototype.verify_sig = function (key, cb) {\n      var computed, err, received, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n\n      __iced_k = __iced_k_noop;\n      ___iced_passed_deferral = iced.findDeferral(arguments);\n      (function (_this) {\n        return function (__iced_k) {\n          if ((received = _this.ct.unshift(Concat.get_output_size() / 4)) == null) {\n            return __iced_k(err = new Error(\"Ciphertext underrun in signature\"));\n          } else {\n            (function (__iced_k) {\n              __iced_deferrals = new iced.Deferrals(__iced_k, {\n                parent: ___iced_passed_deferral,\n                filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                funcname: \"Decryptor.verify_sig\"\n              });\n\n              _this.sign({\n                input: _this.ct,\n                key: key,\n                salt: _this.salt\n              }, __iced_deferrals.defer({\n                assign_fn: function () {\n                  return function () {\n                    err = arguments[0];\n                    return computed = arguments[1];\n                  };\n                }(),\n                lineno: 63\n              }));\n\n              __iced_deferrals._fulfill();\n            })(function () {\n              return __iced_k(err = err != null ? err : received.equal(computed) ? null : new Error('Signature mismatch or bad decryption key'));\n            });\n          }\n        };\n      })(this)(function (_this) {\n        return function () {\n          return cb(err);\n        };\n      }(this));\n    };\n\n    Decryptor.prototype.unshift_iv = function (n_bytes, which, cb) {\n      var err, iv;\n      err = (iv = this.ct.unshift(n_bytes / 4)) != null ? null : new Error(\"Ciphertext underrun in \" + which);\n      return cb(err, iv);\n    };\n\n    Decryptor.prototype.read_salt = function (cb) {\n      var err;\n      err = (this.salt = this.ct.unshift(this.version.salt_size / 4)) == null ? new Error(\"Ciphertext underrrun in read_salt\") : null;\n      return cb(err);\n    };\n\n    Decryptor.prototype.generate_keys = function (_arg, cb) {\n      var err, keys, progress_hook, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n\n      __iced_k = __iced_k_noop;\n      ___iced_passed_deferral = iced.findDeferral(arguments);\n      progress_hook = _arg.progress_hook;\n      (function (_this) {\n        return function (__iced_k) {\n          __iced_deferrals = new iced.Deferrals(__iced_k, {\n            parent: ___iced_passed_deferral,\n            filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n            funcname: \"Decryptor.generate_keys\"\n          });\n\n          _this.kdf({\n            salt: _this.salt,\n            progress_hook: progress_hook\n          }, __iced_deferrals.defer({\n            assign_fn: function () {\n              return function () {\n                err = arguments[0];\n                return keys = arguments[1];\n              };\n            }(),\n            lineno: 114\n          }));\n\n          __iced_deferrals._fulfill();\n        };\n      })(this)(function (_this) {\n        return function () {\n          return cb(err, keys);\n        };\n      }(this));\n    };\n\n    Decryptor.prototype.run = function (_arg, cb) {\n      var ct1, ct2, data, esc, iv, progress_hook, pt, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n\n      __iced_k = __iced_k_noop;\n      ___iced_passed_deferral = iced.findDeferral(arguments);\n      data = _arg.data, progress_hook = _arg.progress_hook;\n      esc = make_esc(cb, \"Decryptor::run\");\n      this.ct = WordArray.from_buffer(data);\n      (function (_this) {\n        return function (__iced_k) {\n          __iced_deferrals = new iced.Deferrals(__iced_k, {\n            parent: ___iced_passed_deferral,\n            filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n            funcname: \"Decryptor.run\"\n          });\n\n          _this.read_header(esc(__iced_deferrals.defer({\n            lineno: 141\n          })));\n\n          __iced_deferrals._fulfill();\n        };\n      })(this)(function (_this) {\n        return function () {\n          (function (__iced_k) {\n            __iced_deferrals = new iced.Deferrals(__iced_k, {\n              parent: ___iced_passed_deferral,\n              filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n              funcname: \"Decryptor.run\"\n            });\n\n            _this.read_salt(esc(__iced_deferrals.defer({\n              lineno: 142\n            })));\n\n            __iced_deferrals._fulfill();\n          })(function () {\n            (function (__iced_k) {\n              __iced_deferrals = new iced.Deferrals(__iced_k, {\n                parent: ___iced_passed_deferral,\n                filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                funcname: \"Decryptor.run\"\n              });\n\n              _this.generate_keys({\n                progress_hook: progress_hook\n              }, esc(__iced_deferrals.defer({\n                assign_fn: function (__slot_1) {\n                  return function () {\n                    return __slot_1.keys = arguments[0];\n                  };\n                }(_this),\n                lineno: 143\n              })));\n\n              __iced_deferrals._fulfill();\n            })(function () {\n              (function (__iced_k) {\n                __iced_deferrals = new iced.Deferrals(__iced_k, {\n                  parent: ___iced_passed_deferral,\n                  filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                  funcname: \"Decryptor.run\"\n                });\n\n                _this.verify_sig(_this.keys.hmac, esc(__iced_deferrals.defer({\n                  lineno: 144\n                })));\n\n                __iced_deferrals._fulfill();\n              })(function () {\n                (function (__iced_k) {\n                  __iced_deferrals = new iced.Deferrals(__iced_k, {\n                    parent: ___iced_passed_deferral,\n                    filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                    funcname: \"Decryptor.run\"\n                  });\n\n                  _this.unshift_iv(AES.ivSize, \"AES\", esc(__iced_deferrals.defer({\n                    assign_fn: function () {\n                      return function () {\n                        return iv = arguments[0];\n                      };\n                    }(),\n                    lineno: 145\n                  })));\n\n                  __iced_deferrals._fulfill();\n                })(function () {\n                  (function (__iced_k) {\n                    __iced_deferrals = new iced.Deferrals(__iced_k, {\n                      parent: ___iced_passed_deferral,\n                      filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                      funcname: \"Decryptor.run\"\n                    });\n\n                    _this.run_aes({\n                      iv: iv,\n                      input: _this.ct,\n                      key: _this.keys.aes,\n                      progress_hook: progress_hook\n                    }, esc(__iced_deferrals.defer({\n                      assign_fn: function () {\n                        return function () {\n                          return ct2 = arguments[0];\n                        };\n                      }(),\n                      lineno: 146\n                    })));\n\n                    __iced_deferrals._fulfill();\n                  })(function () {\n                    (function (__iced_k) {\n                      __iced_deferrals = new iced.Deferrals(__iced_k, {\n                        parent: ___iced_passed_deferral,\n                        filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                        funcname: \"Decryptor.run\"\n                      });\n\n                      _this.unshift_iv(TwoFish.ivSize, \"2fish\", esc(__iced_deferrals.defer({\n                        assign_fn: function () {\n                          return function () {\n                            return iv = arguments[0];\n                          };\n                        }(),\n                        lineno: 147\n                      })));\n\n                      __iced_deferrals._fulfill();\n                    })(function () {\n                      (function (__iced_k) {\n                        __iced_deferrals = new iced.Deferrals(__iced_k, {\n                          parent: ___iced_passed_deferral,\n                          filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                          funcname: \"Decryptor.run\"\n                        });\n\n                        _this.run_twofish({\n                          iv: iv,\n                          input: _this.ct,\n                          key: _this.keys.twofish,\n                          progress_hook: progress_hook\n                        }, esc(__iced_deferrals.defer({\n                          assign_fn: function () {\n                            return function () {\n                              return ct1 = arguments[0];\n                            };\n                          }(),\n                          lineno: 148\n                        })));\n\n                        __iced_deferrals._fulfill();\n                      })(function () {\n                        (function (__iced_k) {\n                          __iced_deferrals = new iced.Deferrals(__iced_k, {\n                            parent: ___iced_passed_deferral,\n                            filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                            funcname: \"Decryptor.run\"\n                          });\n\n                          _this.unshift_iv(Salsa20.ivSize, \"Salsa\", esc(__iced_deferrals.defer({\n                            assign_fn: function () {\n                              return function () {\n                                return iv = arguments[0];\n                              };\n                            }(),\n                            lineno: 149\n                          })));\n\n                          __iced_deferrals._fulfill();\n                        })(function () {\n                          (function (__iced_k) {\n                            __iced_deferrals = new iced.Deferrals(__iced_k, {\n                              parent: ___iced_passed_deferral,\n                              filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                              funcname: \"Decryptor.run\"\n                            });\n\n                            _this.run_salsa20({\n                              iv: iv,\n                              input: _this.ct,\n                              key: _this.keys.salsa20,\n                              output_iv: false,\n                              progress_hook: progress_hook\n                            }, esc(__iced_deferrals.defer({\n                              assign_fn: function () {\n                                return function () {\n                                  return pt = arguments[0];\n                                };\n                              }(),\n                              lineno: 150\n                            })));\n\n                            __iced_deferrals._fulfill();\n                          })(function () {\n                            return cb(null, pt.to_buffer());\n                          });\n                        });\n                      });\n                    });\n                  });\n                });\n              });\n            });\n          });\n        };\n      }(this));\n    };\n\n    Decryptor.prototype.clone = function () {\n      var ret, _ref1;\n\n      ret = new Decryptor({\n        key: (_ref1 = this.key) != null ? _ref1.to_buffer() : void 0,\n        rng: this.rng,\n        version: this.version\n      });\n      ret.derived_keys = this.clone_derived_keys();\n      return ret;\n    };\n\n    return Decryptor;\n  }(Base);\n\n  decrypt = function (_arg, cb) {\n    var data, dec, err, key, progress_hook, pt, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n\n    __iced_k = __iced_k_noop;\n    ___iced_passed_deferral = iced.findDeferral(arguments);\n    key = _arg.key, data = _arg.data, progress_hook = _arg.progress_hook;\n    dec = new Decryptor({\n      key: key\n    });\n    (function (_this) {\n      return function (__iced_k) {\n        __iced_deferrals = new iced.Deferrals(__iced_k, {\n          parent: ___iced_passed_deferral,\n          filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\"\n        });\n        dec.run({\n          data: data,\n          progress_hook: progress_hook\n        }, __iced_deferrals.defer({\n          assign_fn: function () {\n            return function () {\n              err = arguments[0];\n              return pt = arguments[1];\n            };\n          }(),\n          lineno: 180\n        }));\n\n        __iced_deferrals._fulfill();\n      };\n    })(this)(function (_this) {\n      return function () {\n        dec.scrub();\n        return cb(err, pt);\n      };\n    }(this));\n  };\n\n  exports.Decryptor = Decryptor;\n  exports.decrypt = decrypt;\n}).call(this);","map":{"version":3,"sources":["/home/os/Desktop/hello-world-tutorial/node_modules/triplesec/lib/dec.js"],"names":["AES","Base","Concat","Decryptor","SHA512","Salsa20","TwoFish","V","WordArray","ctr","decrypt","iced","make_esc","salsa20","__iced_k","__iced_k_noop","_ref","__hasProp","hasOwnProperty","__extends","child","parent","key","call","ctor","constructor","prototype","__super__","require","_super","_arg","enc","derived_keys","read_header","cb","err","wa","ct","unshift","Error","version","words","header","verify_sig","computed","received","___iced_passed_deferral","__iced_deferrals","findDeferral","arguments","_this","get_output_size","Deferrals","filename","funcname","sign","input","salt","defer","assign_fn","lineno","_fulfill","equal","unshift_iv","n_bytes","which","iv","read_salt","salt_size","generate_keys","keys","progress_hook","kdf","run","ct1","ct2","data","esc","pt","from_buffer","__slot_1","hmac","ivSize","run_aes","aes","run_twofish","twofish","run_salsa20","output_iv","to_buffer","clone","ret","_ref1","rng","clone_derived_keys","dec","scrub","exports"],"mappings":"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","sourcesContent":["// Generated by IcedCoffeeScript 108.0.8\n(function() {\n  var AES, Base, Concat, Decryptor, SHA512, Salsa20, TwoFish, V, WordArray, ctr, decrypt, iced, make_esc, salsa20, __iced_k, __iced_k_noop, _ref,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  iced = require('iced-runtime');\n  __iced_k = __iced_k_noop = function() {};\n\n  WordArray = require('./wordarray').WordArray;\n\n  salsa20 = require('./salsa20');\n\n  AES = require('./aes').AES;\n\n  TwoFish = require('./twofish').TwoFish;\n\n  ctr = require('./ctr');\n\n  Concat = require('./combine').Concat;\n\n  SHA512 = require('./sha512').SHA512;\n\n  Salsa20 = require('./salsa20').Salsa20;\n\n  _ref = require('./enc'), Base = _ref.Base, V = _ref.V;\n\n  make_esc = require('iced-error').make_esc;\n\n  Decryptor = (function(_super) {\n    __extends(Decryptor, _super);\n\n    function Decryptor(_arg) {\n      var enc, key;\n      key = _arg.key, enc = _arg.enc;\n      Decryptor.__super__.constructor.call(this, {\n        key: key\n      });\n      if (enc != null) {\n        this.key = enc.key;\n        this.derived_keys = enc.derived_keys;\n      }\n    }\n\n    Decryptor.prototype.read_header = function(cb) {\n      var err, wa;\n      err = (wa = this.ct.unshift(2)) == null ? new Error(\"Ciphertext underrun in header\") : (this.version = V[wa.words[1]]) == null ? new Error(\"bad header; couldn't find a good version (got \" + wa.words[1] + \")\") : wa.words[0] !== this.version.header[0] ? new Error(\"Bad header: unrecognized magic value\") : null;\n      return cb(err);\n    };\n\n    Decryptor.prototype.verify_sig = function(key, cb) {\n      var computed, err, received, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n      __iced_k = __iced_k_noop;\n      ___iced_passed_deferral = iced.findDeferral(arguments);\n      (function(_this) {\n        return (function(__iced_k) {\n          if ((received = _this.ct.unshift(Concat.get_output_size() / 4)) == null) {\n            return __iced_k(err = new Error(\"Ciphertext underrun in signature\"));\n          } else {\n            (function(__iced_k) {\n              __iced_deferrals = new iced.Deferrals(__iced_k, {\n                parent: ___iced_passed_deferral,\n                filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                funcname: \"Decryptor.verify_sig\"\n              });\n              _this.sign({\n                input: _this.ct,\n                key: key,\n                salt: _this.salt\n              }, __iced_deferrals.defer({\n                assign_fn: (function() {\n                  return function() {\n                    err = arguments[0];\n                    return computed = arguments[1];\n                  };\n                })(),\n                lineno: 63\n              }));\n              __iced_deferrals._fulfill();\n            })(function() {\n              return __iced_k(err = err != null ? err : received.equal(computed) ? null : new Error('Signature mismatch or bad decryption key'));\n            });\n          }\n        });\n      })(this)((function(_this) {\n        return function() {\n          return cb(err);\n        };\n      })(this));\n    };\n\n    Decryptor.prototype.unshift_iv = function(n_bytes, which, cb) {\n      var err, iv;\n      err = (iv = this.ct.unshift(n_bytes / 4)) != null ? null : new Error(\"Ciphertext underrun in \" + which);\n      return cb(err, iv);\n    };\n\n    Decryptor.prototype.read_salt = function(cb) {\n      var err;\n      err = (this.salt = this.ct.unshift(this.version.salt_size / 4)) == null ? new Error(\"Ciphertext underrrun in read_salt\") : null;\n      return cb(err);\n    };\n\n    Decryptor.prototype.generate_keys = function(_arg, cb) {\n      var err, keys, progress_hook, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n      __iced_k = __iced_k_noop;\n      ___iced_passed_deferral = iced.findDeferral(arguments);\n      progress_hook = _arg.progress_hook;\n      (function(_this) {\n        return (function(__iced_k) {\n          __iced_deferrals = new iced.Deferrals(__iced_k, {\n            parent: ___iced_passed_deferral,\n            filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n            funcname: \"Decryptor.generate_keys\"\n          });\n          _this.kdf({\n            salt: _this.salt,\n            progress_hook: progress_hook\n          }, __iced_deferrals.defer({\n            assign_fn: (function() {\n              return function() {\n                err = arguments[0];\n                return keys = arguments[1];\n              };\n            })(),\n            lineno: 114\n          }));\n          __iced_deferrals._fulfill();\n        });\n      })(this)((function(_this) {\n        return function() {\n          return cb(err, keys);\n        };\n      })(this));\n    };\n\n    Decryptor.prototype.run = function(_arg, cb) {\n      var ct1, ct2, data, esc, iv, progress_hook, pt, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n      __iced_k = __iced_k_noop;\n      ___iced_passed_deferral = iced.findDeferral(arguments);\n      data = _arg.data, progress_hook = _arg.progress_hook;\n      esc = make_esc(cb, \"Decryptor::run\");\n      this.ct = WordArray.from_buffer(data);\n      (function(_this) {\n        return (function(__iced_k) {\n          __iced_deferrals = new iced.Deferrals(__iced_k, {\n            parent: ___iced_passed_deferral,\n            filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n            funcname: \"Decryptor.run\"\n          });\n          _this.read_header(esc(__iced_deferrals.defer({\n            lineno: 141\n          })));\n          __iced_deferrals._fulfill();\n        });\n      })(this)((function(_this) {\n        return function() {\n          (function(__iced_k) {\n            __iced_deferrals = new iced.Deferrals(__iced_k, {\n              parent: ___iced_passed_deferral,\n              filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n              funcname: \"Decryptor.run\"\n            });\n            _this.read_salt(esc(__iced_deferrals.defer({\n              lineno: 142\n            })));\n            __iced_deferrals._fulfill();\n          })(function() {\n            (function(__iced_k) {\n              __iced_deferrals = new iced.Deferrals(__iced_k, {\n                parent: ___iced_passed_deferral,\n                filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                funcname: \"Decryptor.run\"\n              });\n              _this.generate_keys({\n                progress_hook: progress_hook\n              }, esc(__iced_deferrals.defer({\n                assign_fn: (function(__slot_1) {\n                  return function() {\n                    return __slot_1.keys = arguments[0];\n                  };\n                })(_this),\n                lineno: 143\n              })));\n              __iced_deferrals._fulfill();\n            })(function() {\n              (function(__iced_k) {\n                __iced_deferrals = new iced.Deferrals(__iced_k, {\n                  parent: ___iced_passed_deferral,\n                  filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                  funcname: \"Decryptor.run\"\n                });\n                _this.verify_sig(_this.keys.hmac, esc(__iced_deferrals.defer({\n                  lineno: 144\n                })));\n                __iced_deferrals._fulfill();\n              })(function() {\n                (function(__iced_k) {\n                  __iced_deferrals = new iced.Deferrals(__iced_k, {\n                    parent: ___iced_passed_deferral,\n                    filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                    funcname: \"Decryptor.run\"\n                  });\n                  _this.unshift_iv(AES.ivSize, \"AES\", esc(__iced_deferrals.defer({\n                    assign_fn: (function() {\n                      return function() {\n                        return iv = arguments[0];\n                      };\n                    })(),\n                    lineno: 145\n                  })));\n                  __iced_deferrals._fulfill();\n                })(function() {\n                  (function(__iced_k) {\n                    __iced_deferrals = new iced.Deferrals(__iced_k, {\n                      parent: ___iced_passed_deferral,\n                      filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                      funcname: \"Decryptor.run\"\n                    });\n                    _this.run_aes({\n                      iv: iv,\n                      input: _this.ct,\n                      key: _this.keys.aes,\n                      progress_hook: progress_hook\n                    }, esc(__iced_deferrals.defer({\n                      assign_fn: (function() {\n                        return function() {\n                          return ct2 = arguments[0];\n                        };\n                      })(),\n                      lineno: 146\n                    })));\n                    __iced_deferrals._fulfill();\n                  })(function() {\n                    (function(__iced_k) {\n                      __iced_deferrals = new iced.Deferrals(__iced_k, {\n                        parent: ___iced_passed_deferral,\n                        filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                        funcname: \"Decryptor.run\"\n                      });\n                      _this.unshift_iv(TwoFish.ivSize, \"2fish\", esc(__iced_deferrals.defer({\n                        assign_fn: (function() {\n                          return function() {\n                            return iv = arguments[0];\n                          };\n                        })(),\n                        lineno: 147\n                      })));\n                      __iced_deferrals._fulfill();\n                    })(function() {\n                      (function(__iced_k) {\n                        __iced_deferrals = new iced.Deferrals(__iced_k, {\n                          parent: ___iced_passed_deferral,\n                          filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                          funcname: \"Decryptor.run\"\n                        });\n                        _this.run_twofish({\n                          iv: iv,\n                          input: _this.ct,\n                          key: _this.keys.twofish,\n                          progress_hook: progress_hook\n                        }, esc(__iced_deferrals.defer({\n                          assign_fn: (function() {\n                            return function() {\n                              return ct1 = arguments[0];\n                            };\n                          })(),\n                          lineno: 148\n                        })));\n                        __iced_deferrals._fulfill();\n                      })(function() {\n                        (function(__iced_k) {\n                          __iced_deferrals = new iced.Deferrals(__iced_k, {\n                            parent: ___iced_passed_deferral,\n                            filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                            funcname: \"Decryptor.run\"\n                          });\n                          _this.unshift_iv(Salsa20.ivSize, \"Salsa\", esc(__iced_deferrals.defer({\n                            assign_fn: (function() {\n                              return function() {\n                                return iv = arguments[0];\n                              };\n                            })(),\n                            lineno: 149\n                          })));\n                          __iced_deferrals._fulfill();\n                        })(function() {\n                          (function(__iced_k) {\n                            __iced_deferrals = new iced.Deferrals(__iced_k, {\n                              parent: ___iced_passed_deferral,\n                              filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\",\n                              funcname: \"Decryptor.run\"\n                            });\n                            _this.run_salsa20({\n                              iv: iv,\n                              input: _this.ct,\n                              key: _this.keys.salsa20,\n                              output_iv: false,\n                              progress_hook: progress_hook\n                            }, esc(__iced_deferrals.defer({\n                              assign_fn: (function() {\n                                return function() {\n                                  return pt = arguments[0];\n                                };\n                              })(),\n                              lineno: 150\n                            })));\n                            __iced_deferrals._fulfill();\n                          })(function() {\n                            return cb(null, pt.to_buffer());\n                          });\n                        });\n                      });\n                    });\n                  });\n                });\n              });\n            });\n          });\n        };\n      })(this));\n    };\n\n    Decryptor.prototype.clone = function() {\n      var ret, _ref1;\n      ret = new Decryptor({\n        key: (_ref1 = this.key) != null ? _ref1.to_buffer() : void 0,\n        rng: this.rng,\n        version: this.version\n      });\n      ret.derived_keys = this.clone_derived_keys();\n      return ret;\n    };\n\n    return Decryptor;\n\n  })(Base);\n\n  decrypt = function(_arg, cb) {\n    var data, dec, err, key, progress_hook, pt, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n    __iced_k = __iced_k_noop;\n    ___iced_passed_deferral = iced.findDeferral(arguments);\n    key = _arg.key, data = _arg.data, progress_hook = _arg.progress_hook;\n    dec = new Decryptor({\n      key: key\n    });\n    (function(_this) {\n      return (function(__iced_k) {\n        __iced_deferrals = new iced.Deferrals(__iced_k, {\n          parent: ___iced_passed_deferral,\n          filename: \"/Users/max/src/keybase/triplesec/src/dec.iced\"\n        });\n        dec.run({\n          data: data,\n          progress_hook: progress_hook\n        }, __iced_deferrals.defer({\n          assign_fn: (function() {\n            return function() {\n              err = arguments[0];\n              return pt = arguments[1];\n            };\n          })(),\n          lineno: 180\n        }));\n        __iced_deferrals._fulfill();\n      });\n    })(this)((function(_this) {\n      return function() {\n        dec.scrub();\n        return cb(err, pt);\n      };\n    })(this));\n  };\n\n  exports.Decryptor = Decryptor;\n\n  exports.decrypt = decrypt;\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}