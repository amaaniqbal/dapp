{"ast":null,"code":"// Generated by IcedCoffeeScript 108.0.8\n(function () {\n  var Cipher,\n      Counter,\n      Salsa20,\n      Salsa20Core,\n      Salsa20InnerCore,\n      Salsa20WordStream,\n      StreamCipher,\n      WordArray,\n      asum,\n      bulk_encrypt,\n      encrypt,\n      endian_reverse,\n      fixup_uint32,\n      iced,\n      util,\n      __iced_k,\n      __iced_k_noop,\n      _ref,\n      __hasProp = {}.hasOwnProperty,\n      __extends = function (child, parent) {\n    for (var key in parent) {\n      if (__hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  };\n\n  iced = require('iced-runtime');\n\n  __iced_k = __iced_k_noop = function () {};\n\n  _ref = require('./wordarray'), endian_reverse = _ref.endian_reverse, WordArray = _ref.WordArray;\n  Counter = require('./ctr').Counter;\n  fixup_uint32 = require('./util').fixup_uint32;\n  StreamCipher = require('./algbase').StreamCipher;\n  util = require('./util');\n\n  asum = function (out, v) {\n    var e, i, _i, _len;\n\n    for (i = _i = 0, _len = v.length; _i < _len; i = ++_i) {\n      e = v[i];\n      out[i] += e;\n    }\n\n    return false;\n  };\n\n  Salsa20InnerCore = function () {\n    function Salsa20InnerCore(rounds) {\n      this.rounds = rounds;\n    }\n\n    Salsa20InnerCore.prototype._core = function (v) {\n      var i, u, x0, x1, x10, x11, x12, x13, x14, x15, x2, x3, x4, x5, x6, x7, x8, x9, _i, _ref1;\n\n      x0 = v[0], x1 = v[1], x2 = v[2], x3 = v[3], x4 = v[4], x5 = v[5], x6 = v[6], x7 = v[7], x8 = v[8], x9 = v[9], x10 = v[10], x11 = v[11], x12 = v[12], x13 = v[13], x14 = v[14], x15 = v[15];\n\n      for (i = _i = 0, _ref1 = this.rounds; _i < _ref1; i = _i += 2) {\n        u = x0 + x12 | 0;\n        x4 ^= u << 7 | u >>> 25;\n        u = x4 + x0 | 0;\n        x8 ^= u << 9 | u >>> 23;\n        u = x8 + x4 | 0;\n        x12 ^= u << 13 | u >>> 19;\n        u = x12 + x8 | 0;\n        x0 ^= u << 18 | u >>> 14;\n        u = x5 + x1 | 0;\n        x9 ^= u << 7 | u >>> 25;\n        u = x9 + x5 | 0;\n        x13 ^= u << 9 | u >>> 23;\n        u = x13 + x9 | 0;\n        x1 ^= u << 13 | u >>> 19;\n        u = x1 + x13 | 0;\n        x5 ^= u << 18 | u >>> 14;\n        u = x10 + x6 | 0;\n        x14 ^= u << 7 | u >>> 25;\n        u = x14 + x10 | 0;\n        x2 ^= u << 9 | u >>> 23;\n        u = x2 + x14 | 0;\n        x6 ^= u << 13 | u >>> 19;\n        u = x6 + x2 | 0;\n        x10 ^= u << 18 | u >>> 14;\n        u = x15 + x11 | 0;\n        x3 ^= u << 7 | u >>> 25;\n        u = x3 + x15 | 0;\n        x7 ^= u << 9 | u >>> 23;\n        u = x7 + x3 | 0;\n        x11 ^= u << 13 | u >>> 19;\n        u = x11 + x7 | 0;\n        x15 ^= u << 18 | u >>> 14;\n        u = x0 + x3 | 0;\n        x1 ^= u << 7 | u >>> 25;\n        u = x1 + x0 | 0;\n        x2 ^= u << 9 | u >>> 23;\n        u = x2 + x1 | 0;\n        x3 ^= u << 13 | u >>> 19;\n        u = x3 + x2 | 0;\n        x0 ^= u << 18 | u >>> 14;\n        u = x5 + x4 | 0;\n        x6 ^= u << 7 | u >>> 25;\n        u = x6 + x5 | 0;\n        x7 ^= u << 9 | u >>> 23;\n        u = x7 + x6 | 0;\n        x4 ^= u << 13 | u >>> 19;\n        u = x4 + x7 | 0;\n        x5 ^= u << 18 | u >>> 14;\n        u = x10 + x9 | 0;\n        x11 ^= u << 7 | u >>> 25;\n        u = x11 + x10 | 0;\n        x8 ^= u << 9 | u >>> 23;\n        u = x8 + x11 | 0;\n        x9 ^= u << 13 | u >>> 19;\n        u = x9 + x8 | 0;\n        x10 ^= u << 18 | u >>> 14;\n        u = x15 + x14 | 0;\n        x12 ^= u << 7 | u >>> 25;\n        u = x12 + x15 | 0;\n        x13 ^= u << 9 | u >>> 23;\n        u = x13 + x12 | 0;\n        x14 ^= u << 13 | u >>> 19;\n        u = x14 + x13 | 0;\n        x15 ^= u << 18 | u >>> 14;\n      }\n\n      return [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15];\n    };\n\n    return Salsa20InnerCore;\n  }();\n\n  Salsa20Core = function (_super) {\n    __extends(Salsa20Core, _super);\n\n    Salsa20Core.prototype.sigma = WordArray.from_buffer_le(new Buffer(\"expand 32-byte k\"));\n    Salsa20Core.prototype.tau = WordArray.from_buffer_le(new Buffer(\"expand 16-byte k\"));\n    Salsa20Core.blockSize = 64;\n    Salsa20Core.prototype.blockSize = Salsa20Core.blockSize;\n    Salsa20Core.keySize = 32;\n    Salsa20Core.prototype.keySize = Salsa20Core.keySize;\n    Salsa20Core.ivSize = 192 / 8;\n    Salsa20Core.prototype.ivSize = Salsa20Core.ivSize;\n\n    function Salsa20Core(key, nonce) {\n      var _ref1;\n\n      Salsa20Core.__super__.constructor.call(this, 20);\n\n      this.key = key.clone().endian_reverse();\n      this.nonce = nonce.clone().endian_reverse();\n\n      if (!(this.key.sigBytes === 16 && this.nonce.sigBytes === 8 || this.key.sigBytes === 32 && ((_ref1 = this.nonce.sigBytes) === 8 || _ref1 === 24))) {\n        throw new Error(\"Bad key/nonce lengths\");\n      }\n\n      if (this.nonce.sigBytes === 24) {\n        this.xsalsa_setup();\n      }\n\n      this.input = this.key_iv_setup(this.nonce, this.key);\n\n      this._reset();\n    }\n\n    Salsa20Core.prototype.scrub = function () {\n      this.key.scrub();\n      this.nonce.scrub();\n      return util.scrub_vec(this.input);\n    };\n\n    Salsa20Core.prototype.xsalsa_setup = function () {\n      var n0, n1;\n      n0 = new WordArray(this.nonce.words.slice(0, 4));\n      this.nonce = n1 = new WordArray(this.nonce.words.slice(4));\n      return this.key = this.hsalsa20(n0, this.key);\n    };\n\n    Salsa20Core.prototype.hsalsa20 = function (nonce, key) {\n      var i, indexes, input, v;\n      input = this.key_iv_setup(nonce, key);\n      input[8] = nonce.words[2];\n      input[9] = nonce.words[3];\n      v = this._core(input);\n      indexes = [0, 5, 10, 15, 6, 7, 8, 9];\n\n      v = function () {\n        var _i, _len, _results;\n\n        _results = [];\n\n        for (_i = 0, _len = indexes.length; _i < _len; _i++) {\n          i = indexes[_i];\n\n          _results.push(fixup_uint32(v[i]));\n        }\n\n        return _results;\n      }();\n\n      util.scrub_vec(input);\n      return new WordArray(v);\n    };\n\n    Salsa20Core.prototype.key_iv_setup = function (nonce, key) {\n      var A, C, i, out, _i, _j, _k, _ref1;\n\n      out = [];\n\n      for (i = _i = 0; _i < 4; i = ++_i) {\n        out[i + 1] = key.words[i];\n      }\n\n      _ref1 = key.sigBytes === 32 ? [this.sigma, key.words.slice(4)] : [this.tau, key.words], C = _ref1[0], A = _ref1[1];\n\n      for (i = _j = 0; _j < 4; i = ++_j) {\n        out[i + 11] = A[i];\n      }\n\n      for (i = _k = 0; _k < 4; i = ++_k) {\n        out[i * 5] = C.words[i];\n      }\n\n      out[6] = nonce.words[0];\n      out[7] = nonce.words[1];\n      return out;\n    };\n\n    Salsa20Core.prototype.counter_setup = function () {\n      this.input[8] = this.counter.get().words[0];\n      return this.input[9] = this.counter.get().words[1];\n    };\n\n    Salsa20Core.prototype._reset = function () {\n      return this.counter = new Counter({\n        len: 2\n      });\n    };\n\n    Salsa20Core.prototype._generateBlock = function () {\n      var v;\n      this.counter_setup();\n      v = this._core(this.input);\n      asum(v, this.input);\n      this.counter.inc_le();\n      return v;\n    };\n\n    return Salsa20Core;\n  }(Salsa20InnerCore);\n\n  exports.Salsa20WordStream = Salsa20WordStream = function (_super) {\n    __extends(Salsa20WordStream, _super);\n\n    function Salsa20WordStream() {\n      return Salsa20WordStream.__super__.constructor.apply(this, arguments);\n    }\n\n    Salsa20WordStream.prototype._reset = function () {\n      return Salsa20WordStream.__super__._reset.call(this);\n    };\n\n    Salsa20WordStream.prototype.getWordArray = function (nbytes) {\n      var blocks, i, nblocks, w, words, _i, _len, _ref1;\n\n      if (nbytes == null || nbytes === this.blockSize) {\n        words = this._generateBlock();\n      } else {\n        nblocks = Math.ceil(nbytes / this.blockSize);\n\n        blocks = function () {\n          var _i, _results;\n\n          _results = [];\n\n          for (i = _i = 0; 0 <= nblocks ? _i < nblocks : _i > nblocks; i = 0 <= nblocks ? ++_i : --_i) {\n            _results.push(this._generateBlock());\n          }\n\n          return _results;\n        }.call(this);\n\n        words = (_ref1 = []).concat.apply(_ref1, blocks);\n      }\n\n      for (i = _i = 0, _len = words.length; _i < _len; i = ++_i) {\n        w = words[i];\n        words[i] = endian_reverse(w);\n      }\n\n      return new WordArray(words, nbytes);\n    };\n\n    return Salsa20WordStream;\n  }(Salsa20Core);\n\n  exports.Salsa20 = Salsa20 = function (_super) {\n    __extends(Salsa20, _super);\n\n    function Salsa20() {\n      return Salsa20.__super__.constructor.apply(this, arguments);\n    }\n\n    Salsa20.prototype._reset = function () {\n      Salsa20.__super__._reset.call(this);\n\n      return this._i = this.blockSize;\n    };\n\n    Salsa20.prototype.getBytes = function (needed) {\n      var bsz, n, v;\n\n      if (needed == null) {\n        needed = this.blockSize;\n      }\n\n      v = [];\n      bsz = this.blockSize;\n\n      if (this._i === bsz && needed === bsz) {\n        return this._generateBlockBuffer();\n      } else {\n        while (needed > 0) {\n          if (this._i === bsz) {\n            this._generateBlockBuffer();\n\n            this._i = 0;\n          }\n\n          n = Math.min(needed, bsz - this._i);\n          v.push(n === bsz ? this._buf : this._buf.slice(this._i, this._i + n));\n          this._i += n;\n          needed -= n;\n        }\n\n        return Buffer.concat(v);\n      }\n    };\n\n    Salsa20.prototype._generateBlockBuffer = function () {\n      var e, i, v, _i, _len;\n\n      this._buf = new Buffer(this.blockSize);\n      v = this._generateBlock();\n\n      for (i = _i = 0, _len = v.length; _i < _len; i = ++_i) {\n        e = v[i];\n\n        this._buf.writeUInt32LE(fixup_uint32(e), i * 4);\n      }\n\n      return this._buf;\n    };\n\n    return Salsa20;\n  }(Salsa20Core);\n\n  exports.Cipher = Cipher = function (_super) {\n    __extends(Cipher, _super);\n\n    function Cipher(_arg) {\n      var iv, key;\n      key = _arg.key, iv = _arg.iv;\n\n      Cipher.__super__.constructor.call(this);\n\n      this.salsa = new Salsa20WordStream(key, iv);\n      this.bsiw = this.salsa.blockSize / 4;\n    }\n\n    Cipher.prototype.scrub = function () {\n      return this.salsa.scrub();\n    };\n\n    Cipher.prototype.get_pad = function () {\n      var pad;\n      pad = this.salsa.getWordArray();\n      return pad;\n    };\n\n    return Cipher;\n  }(StreamCipher);\n\n  exports.encrypt = encrypt = function (_arg) {\n    var cipher, input, iv, key, ret;\n    key = _arg.key, iv = _arg.iv, input = _arg.input;\n    cipher = new Cipher({\n      key: key,\n      iv: iv\n    });\n    ret = cipher.encrypt(input);\n    cipher.scrub();\n    return ret;\n  };\n\n  exports.bulk_encrypt = bulk_encrypt = function (_arg, cb) {\n    var cipher, input, iv, key, progress_hook, ret, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n\n    __iced_k = __iced_k_noop;\n    ___iced_passed_deferral = iced.findDeferral(arguments);\n    key = _arg.key, iv = _arg.iv, input = _arg.input, progress_hook = _arg.progress_hook;\n    cipher = new Cipher({\n      key: key,\n      iv: iv\n    });\n    (function (_this) {\n      return function (__iced_k) {\n        __iced_deferrals = new iced.Deferrals(__iced_k, {\n          parent: ___iced_passed_deferral,\n          filename: \"/Users/max/src/keybase/triplesec/src/salsa20.iced\"\n        });\n        cipher.bulk_encrypt({\n          input: input,\n          progress_hook: progress_hook,\n          what: \"salsa20\"\n        }, __iced_deferrals.defer({\n          assign_fn: function () {\n            return function () {\n              return ret = arguments[0];\n            };\n          }(),\n          lineno: 256\n        }));\n\n        __iced_deferrals._fulfill();\n      };\n    })(this)(function (_this) {\n      return function () {\n        cipher.scrub();\n        return cb(ret);\n      };\n    }(this));\n  };\n\n  exports.Salsa20InnerCore = Salsa20InnerCore;\n  exports.endian_reverse = endian_reverse;\n  exports.asum = asum;\n}).call(this);","map":{"version":3,"sources":["/home/os/Desktop/hello-world-tutorial/node_modules/triplesec/lib/salsa20.js"],"names":["Cipher","Counter","Salsa20","Salsa20Core","Salsa20InnerCore","Salsa20WordStream","StreamCipher","WordArray","asum","bulk_encrypt","encrypt","endian_reverse","fixup_uint32","iced","util","__iced_k","__iced_k_noop","_ref","__hasProp","hasOwnProperty","__extends","child","parent","key","call","ctor","constructor","prototype","__super__","require","out","v","e","i","_i","_len","length","rounds","_core","u","x0","x1","x10","x11","x12","x13","x14","x15","x2","x3","x4","x5","x6","x7","x8","x9","_ref1","_super","sigma","from_buffer_le","Buffer","tau","blockSize","keySize","ivSize","nonce","clone","sigBytes","Error","xsalsa_setup","input","key_iv_setup","_reset","scrub","scrub_vec","n0","n1","words","slice","hsalsa20","indexes","_results","push","A","C","_j","_k","counter_setup","counter","get","len","_generateBlock","inc_le","exports","apply","arguments","getWordArray","nbytes","blocks","nblocks","w","Math","ceil","concat","getBytes","needed","bsz","n","_generateBlockBuffer","min","_buf","writeUInt32LE","_arg","iv","salsa","bsiw","get_pad","pad","cipher","ret","cb","progress_hook","___iced_passed_deferral","__iced_deferrals","findDeferral","_this","Deferrals","filename","what","defer","assign_fn","lineno","_fulfill"],"mappings":"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","sourcesContent":["// Generated by IcedCoffeeScript 108.0.8\n(function() {\n  var Cipher, Counter, Salsa20, Salsa20Core, Salsa20InnerCore, Salsa20WordStream, StreamCipher, WordArray, asum, bulk_encrypt, encrypt, endian_reverse, fixup_uint32, iced, util, __iced_k, __iced_k_noop, _ref,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  iced = require('iced-runtime');\n  __iced_k = __iced_k_noop = function() {};\n\n  _ref = require('./wordarray'), endian_reverse = _ref.endian_reverse, WordArray = _ref.WordArray;\n\n  Counter = require('./ctr').Counter;\n\n  fixup_uint32 = require('./util').fixup_uint32;\n\n  StreamCipher = require('./algbase').StreamCipher;\n\n  util = require('./util');\n\n  asum = function(out, v) {\n    var e, i, _i, _len;\n    for (i = _i = 0, _len = v.length; _i < _len; i = ++_i) {\n      e = v[i];\n      out[i] += e;\n    }\n    return false;\n  };\n\n  Salsa20InnerCore = (function() {\n    function Salsa20InnerCore(rounds) {\n      this.rounds = rounds;\n    }\n\n    Salsa20InnerCore.prototype._core = function(v) {\n      var i, u, x0, x1, x10, x11, x12, x13, x14, x15, x2, x3, x4, x5, x6, x7, x8, x9, _i, _ref1;\n      x0 = v[0], x1 = v[1], x2 = v[2], x3 = v[3], x4 = v[4], x5 = v[5], x6 = v[6], x7 = v[7], x8 = v[8], x9 = v[9], x10 = v[10], x11 = v[11], x12 = v[12], x13 = v[13], x14 = v[14], x15 = v[15];\n      for (i = _i = 0, _ref1 = this.rounds; _i < _ref1; i = _i += 2) {\n        u = (x0 + x12) | 0;\n        x4 ^= (u << 7) | (u >>> 25);\n        u = (x4 + x0) | 0;\n        x8 ^= (u << 9) | (u >>> 23);\n        u = (x8 + x4) | 0;\n        x12 ^= (u << 13) | (u >>> 19);\n        u = (x12 + x8) | 0;\n        x0 ^= (u << 18) | (u >>> 14);\n        u = (x5 + x1) | 0;\n        x9 ^= (u << 7) | (u >>> 25);\n        u = (x9 + x5) | 0;\n        x13 ^= (u << 9) | (u >>> 23);\n        u = (x13 + x9) | 0;\n        x1 ^= (u << 13) | (u >>> 19);\n        u = (x1 + x13) | 0;\n        x5 ^= (u << 18) | (u >>> 14);\n        u = (x10 + x6) | 0;\n        x14 ^= (u << 7) | (u >>> 25);\n        u = (x14 + x10) | 0;\n        x2 ^= (u << 9) | (u >>> 23);\n        u = (x2 + x14) | 0;\n        x6 ^= (u << 13) | (u >>> 19);\n        u = (x6 + x2) | 0;\n        x10 ^= (u << 18) | (u >>> 14);\n        u = (x15 + x11) | 0;\n        x3 ^= (u << 7) | (u >>> 25);\n        u = (x3 + x15) | 0;\n        x7 ^= (u << 9) | (u >>> 23);\n        u = (x7 + x3) | 0;\n        x11 ^= (u << 13) | (u >>> 19);\n        u = (x11 + x7) | 0;\n        x15 ^= (u << 18) | (u >>> 14);\n        u = (x0 + x3) | 0;\n        x1 ^= (u << 7) | (u >>> 25);\n        u = (x1 + x0) | 0;\n        x2 ^= (u << 9) | (u >>> 23);\n        u = (x2 + x1) | 0;\n        x3 ^= (u << 13) | (u >>> 19);\n        u = (x3 + x2) | 0;\n        x0 ^= (u << 18) | (u >>> 14);\n        u = (x5 + x4) | 0;\n        x6 ^= (u << 7) | (u >>> 25);\n        u = (x6 + x5) | 0;\n        x7 ^= (u << 9) | (u >>> 23);\n        u = (x7 + x6) | 0;\n        x4 ^= (u << 13) | (u >>> 19);\n        u = (x4 + x7) | 0;\n        x5 ^= (u << 18) | (u >>> 14);\n        u = (x10 + x9) | 0;\n        x11 ^= (u << 7) | (u >>> 25);\n        u = (x11 + x10) | 0;\n        x8 ^= (u << 9) | (u >>> 23);\n        u = (x8 + x11) | 0;\n        x9 ^= (u << 13) | (u >>> 19);\n        u = (x9 + x8) | 0;\n        x10 ^= (u << 18) | (u >>> 14);\n        u = (x15 + x14) | 0;\n        x12 ^= (u << 7) | (u >>> 25);\n        u = (x12 + x15) | 0;\n        x13 ^= (u << 9) | (u >>> 23);\n        u = (x13 + x12) | 0;\n        x14 ^= (u << 13) | (u >>> 19);\n        u = (x14 + x13) | 0;\n        x15 ^= (u << 18) | (u >>> 14);\n      }\n      return [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15];\n    };\n\n    return Salsa20InnerCore;\n\n  })();\n\n  Salsa20Core = (function(_super) {\n    __extends(Salsa20Core, _super);\n\n    Salsa20Core.prototype.sigma = WordArray.from_buffer_le(new Buffer(\"expand 32-byte k\"));\n\n    Salsa20Core.prototype.tau = WordArray.from_buffer_le(new Buffer(\"expand 16-byte k\"));\n\n    Salsa20Core.blockSize = 64;\n\n    Salsa20Core.prototype.blockSize = Salsa20Core.blockSize;\n\n    Salsa20Core.keySize = 32;\n\n    Salsa20Core.prototype.keySize = Salsa20Core.keySize;\n\n    Salsa20Core.ivSize = 192 / 8;\n\n    Salsa20Core.prototype.ivSize = Salsa20Core.ivSize;\n\n    function Salsa20Core(key, nonce) {\n      var _ref1;\n      Salsa20Core.__super__.constructor.call(this, 20);\n      this.key = key.clone().endian_reverse();\n      this.nonce = nonce.clone().endian_reverse();\n      if (!(((this.key.sigBytes === 16) && (this.nonce.sigBytes === 8)) || ((this.key.sigBytes === 32) && ((_ref1 = this.nonce.sigBytes) === 8 || _ref1 === 24)))) {\n        throw new Error(\"Bad key/nonce lengths\");\n      }\n      if (this.nonce.sigBytes === 24) {\n        this.xsalsa_setup();\n      }\n      this.input = this.key_iv_setup(this.nonce, this.key);\n      this._reset();\n    }\n\n    Salsa20Core.prototype.scrub = function() {\n      this.key.scrub();\n      this.nonce.scrub();\n      return util.scrub_vec(this.input);\n    };\n\n    Salsa20Core.prototype.xsalsa_setup = function() {\n      var n0, n1;\n      n0 = new WordArray(this.nonce.words.slice(0, 4));\n      this.nonce = n1 = new WordArray(this.nonce.words.slice(4));\n      return this.key = this.hsalsa20(n0, this.key);\n    };\n\n    Salsa20Core.prototype.hsalsa20 = function(nonce, key) {\n      var i, indexes, input, v;\n      input = this.key_iv_setup(nonce, key);\n      input[8] = nonce.words[2];\n      input[9] = nonce.words[3];\n      v = this._core(input);\n      indexes = [0, 5, 10, 15, 6, 7, 8, 9];\n      v = (function() {\n        var _i, _len, _results;\n        _results = [];\n        for (_i = 0, _len = indexes.length; _i < _len; _i++) {\n          i = indexes[_i];\n          _results.push(fixup_uint32(v[i]));\n        }\n        return _results;\n      })();\n      util.scrub_vec(input);\n      return new WordArray(v);\n    };\n\n    Salsa20Core.prototype.key_iv_setup = function(nonce, key) {\n      var A, C, i, out, _i, _j, _k, _ref1;\n      out = [];\n      for (i = _i = 0; _i < 4; i = ++_i) {\n        out[i + 1] = key.words[i];\n      }\n      _ref1 = key.sigBytes === 32 ? [this.sigma, key.words.slice(4)] : [this.tau, key.words], C = _ref1[0], A = _ref1[1];\n      for (i = _j = 0; _j < 4; i = ++_j) {\n        out[i + 11] = A[i];\n      }\n      for (i = _k = 0; _k < 4; i = ++_k) {\n        out[i * 5] = C.words[i];\n      }\n      out[6] = nonce.words[0];\n      out[7] = nonce.words[1];\n      return out;\n    };\n\n    Salsa20Core.prototype.counter_setup = function() {\n      this.input[8] = this.counter.get().words[0];\n      return this.input[9] = this.counter.get().words[1];\n    };\n\n    Salsa20Core.prototype._reset = function() {\n      return this.counter = new Counter({\n        len: 2\n      });\n    };\n\n    Salsa20Core.prototype._generateBlock = function() {\n      var v;\n      this.counter_setup();\n      v = this._core(this.input);\n      asum(v, this.input);\n      this.counter.inc_le();\n      return v;\n    };\n\n    return Salsa20Core;\n\n  })(Salsa20InnerCore);\n\n  exports.Salsa20WordStream = Salsa20WordStream = (function(_super) {\n    __extends(Salsa20WordStream, _super);\n\n    function Salsa20WordStream() {\n      return Salsa20WordStream.__super__.constructor.apply(this, arguments);\n    }\n\n    Salsa20WordStream.prototype._reset = function() {\n      return Salsa20WordStream.__super__._reset.call(this);\n    };\n\n    Salsa20WordStream.prototype.getWordArray = function(nbytes) {\n      var blocks, i, nblocks, w, words, _i, _len, _ref1;\n      if ((nbytes == null) || nbytes === this.blockSize) {\n        words = this._generateBlock();\n      } else {\n        nblocks = Math.ceil(nbytes / this.blockSize);\n        blocks = (function() {\n          var _i, _results;\n          _results = [];\n          for (i = _i = 0; 0 <= nblocks ? _i < nblocks : _i > nblocks; i = 0 <= nblocks ? ++_i : --_i) {\n            _results.push(this._generateBlock());\n          }\n          return _results;\n        }).call(this);\n        words = (_ref1 = []).concat.apply(_ref1, blocks);\n      }\n      for (i = _i = 0, _len = words.length; _i < _len; i = ++_i) {\n        w = words[i];\n        words[i] = endian_reverse(w);\n      }\n      return new WordArray(words, nbytes);\n    };\n\n    return Salsa20WordStream;\n\n  })(Salsa20Core);\n\n  exports.Salsa20 = Salsa20 = (function(_super) {\n    __extends(Salsa20, _super);\n\n    function Salsa20() {\n      return Salsa20.__super__.constructor.apply(this, arguments);\n    }\n\n    Salsa20.prototype._reset = function() {\n      Salsa20.__super__._reset.call(this);\n      return this._i = this.blockSize;\n    };\n\n    Salsa20.prototype.getBytes = function(needed) {\n      var bsz, n, v;\n      if (needed == null) {\n        needed = this.blockSize;\n      }\n      v = [];\n      bsz = this.blockSize;\n      if ((this._i === bsz) && (needed === bsz)) {\n        return this._generateBlockBuffer();\n      } else {\n        while (needed > 0) {\n          if (this._i === bsz) {\n            this._generateBlockBuffer();\n            this._i = 0;\n          }\n          n = Math.min(needed, bsz - this._i);\n          v.push((n === bsz ? this._buf : this._buf.slice(this._i, this._i + n)));\n          this._i += n;\n          needed -= n;\n        }\n        return Buffer.concat(v);\n      }\n    };\n\n    Salsa20.prototype._generateBlockBuffer = function() {\n      var e, i, v, _i, _len;\n      this._buf = new Buffer(this.blockSize);\n      v = this._generateBlock();\n      for (i = _i = 0, _len = v.length; _i < _len; i = ++_i) {\n        e = v[i];\n        this._buf.writeUInt32LE(fixup_uint32(e), i * 4);\n      }\n      return this._buf;\n    };\n\n    return Salsa20;\n\n  })(Salsa20Core);\n\n  exports.Cipher = Cipher = (function(_super) {\n    __extends(Cipher, _super);\n\n    function Cipher(_arg) {\n      var iv, key;\n      key = _arg.key, iv = _arg.iv;\n      Cipher.__super__.constructor.call(this);\n      this.salsa = new Salsa20WordStream(key, iv);\n      this.bsiw = this.salsa.blockSize / 4;\n    }\n\n    Cipher.prototype.scrub = function() {\n      return this.salsa.scrub();\n    };\n\n    Cipher.prototype.get_pad = function() {\n      var pad;\n      pad = this.salsa.getWordArray();\n      return pad;\n    };\n\n    return Cipher;\n\n  })(StreamCipher);\n\n  exports.encrypt = encrypt = function(_arg) {\n    var cipher, input, iv, key, ret;\n    key = _arg.key, iv = _arg.iv, input = _arg.input;\n    cipher = new Cipher({\n      key: key,\n      iv: iv\n    });\n    ret = cipher.encrypt(input);\n    cipher.scrub();\n    return ret;\n  };\n\n  exports.bulk_encrypt = bulk_encrypt = function(_arg, cb) {\n    var cipher, input, iv, key, progress_hook, ret, ___iced_passed_deferral, __iced_deferrals, __iced_k;\n    __iced_k = __iced_k_noop;\n    ___iced_passed_deferral = iced.findDeferral(arguments);\n    key = _arg.key, iv = _arg.iv, input = _arg.input, progress_hook = _arg.progress_hook;\n    cipher = new Cipher({\n      key: key,\n      iv: iv\n    });\n    (function(_this) {\n      return (function(__iced_k) {\n        __iced_deferrals = new iced.Deferrals(__iced_k, {\n          parent: ___iced_passed_deferral,\n          filename: \"/Users/max/src/keybase/triplesec/src/salsa20.iced\"\n        });\n        cipher.bulk_encrypt({\n          input: input,\n          progress_hook: progress_hook,\n          what: \"salsa20\"\n        }, __iced_deferrals.defer({\n          assign_fn: (function() {\n            return function() {\n              return ret = arguments[0];\n            };\n          })(),\n          lineno: 256\n        }));\n        __iced_deferrals._fulfill();\n      });\n    })(this)((function(_this) {\n      return function() {\n        cipher.scrub();\n        return cb(ret);\n      };\n    })(this));\n  };\n\n  exports.Salsa20InnerCore = Salsa20InnerCore;\n\n  exports.endian_reverse = endian_reverse;\n\n  exports.asum = asum;\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}